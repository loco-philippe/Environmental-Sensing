<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.8.1" />
<title>ES.EStestunitaire API documentation</title>
<meta name="description" content="Created on Sun Aug
1 22:05:08 2021 …" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>ES.EStestunitaire</code></h1>
</header>
<section id="section-intro">
<p>Created on Sun Aug
1 22:05:08 2021</p>
<p>@author: a179227</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python"># -*- coding: utf-8 -*-
&#34;&#34;&#34;
Created on Sun Aug  1 22:05:08 2021

@author: a179227
&#34;&#34;&#34;
import unittest

from ESElement import ESElement
from ESValue import ResultValue, LocationValue, DatationValue, \
    PropertyValue, ESValue, gshape, ESSet
from ESObservation import Observation
from ESObs import ESSetDatation, ESSetProperty, ESSetResult, ESSetLocation
from copy import copy
from ESconstante import ES
import json
import requests as rq
from datetime import datetime


# datas-----------------------------------------------------------------------
def val_(n): return list(i for i in range(n))
def res_(n): return (ES.res_valName[0], val_(n))
with open(&#39;C:\\Users\\a179227\\OneDrive - Alliance\\perso Wx\\ES standard\\python ESstandard\\departements-version-simplifiee.geojson&#39;) as f: 
    dp = f.read()
dpt = json.loads(dp)
pol13 = dpt[&#39;features&#39;][12][&#39;geometry&#39;][&#39;coordinates&#39;]
pol69 = dpt[&#39;features&#39;][69][&#39;geometry&#39;][&#39;coordinates&#39;]
pol75 = dpt[&#39;features&#39;][75][&#39;geometry&#39;][&#39;coordinates&#39;]
pol1 = [[[0.0,1.0], [1.0,2.0], [1.0,1.0], [0.0,1.0]]]
pol1centre = [0.6666666666666666, 1.3333333333333333]
pol2 = [[[0.0,2.0], [2.0,2.0], [1.0,1.0], [0.0,2.0]]]
dpt2 = (ES.loc_valName[1], [pol1, pol2])
dpt3 = (ES.loc_valName[1], [pol75, pol69, pol13])
pparis       = [2.4, 48.9]
plyon        = [4.8, 45.8]
pmarseille   = [5.4, 43.3]
paris       = [2.35, 48.87]
parisn      = json.dumps({&#39;loca1&#39; : paris})
lyon        = [4.83, 45.76]
marseille   = [5.38, 43.3]
mini_PL     = [2.35, 45.76]
maxi_PLM    = [5.38, 48.87]
obs_1       = (ES.type, ES.obs_classES)
truc_mach   = (&#34;truc&#34;, &#34;machin&#34;)
prop_pm25   = dict([(ES.prp_propType,&#34;PM25&#34;), (ES.prp_unit, &#34;kg/m3&#34;)])
prop_pm10   = dict([(ES.prp_propType,&#34;PM10&#34;), (ES.prp_unit, &#34;kg/m3&#34;)])
prop_co2    = dict([(ES.prp_propType,&#34;CO2&#34;), (ES.prp_unit, &#34;kg/m3&#34;)])
pprop_pm25   = dict([(ES.prp_propType,&#34;PM25&#34;), (ES.prp_unit, &#34;kg/m3&#34;), (ES.prp_appli, &#34;air&#34;)])
pprop_pm10   = dict([(ES.prp_propType,&#34;PM10&#34;), (ES.prp_unit, &#34;kg/m3&#34;), (ES.prp_appli, &#34;air&#34;), (&#34;truc&#34;, &#34;machin&#34;)])
pt1 = datetime(2020, 2, 4, 12, 5, 0)
pt2 = datetime(2020, 5, 4, 12, 5, 0)
pt3 = datetime(2020, 7, 4, 12, 5, 0)
tnull = datetime(1970, 1, 1, 0, 0, 0)
snull = (tnull.isoformat(), tnull.isoformat())
t1 = datetime(2021, 2, 4, 12, 5, 0)
t1n = json.dumps({&#39;date1&#39; : t1.isoformat()})
t2 = datetime(2021, 7, 4, 12, 5, 0)
t3 = datetime(2021, 5, 4, 12, 5, 0)
r1 = ResultValue(&#39;{&#34;er&#34;:2}&#39;)
r2 = ResultValue([23, [1, 2, -1]])
r3 = ResultValue([&#34;coucou&#34;, [1, 2, -1]])
r4 = ResultValue(41.2)
r5 = ResultValue(18)
r6 = ResultValue([41, [2, 2, 0]])
r7 = ResultValue([18, [1, 2, 1]])
s1 = [t1, t2]
#ndat1 = (ES.dat_valName[2], &#34;date1&#34;)
#ndat2 = (ES.dat_valName[2], [&#34;1date1&#34;, &#34;2date2&#34;])
#ndat3 = (ES.dat_valName[2], [&#34;1date1&#34;, &#34;2date2&#34;, &#34;3date3&#34;])
dat1 = (ES.dat_valName[0], {&#39;date1&#39; : t1.isoformat()})
dat2 = (ES.dat_valName[0], [t1.isoformat(), t2.isoformat()])
dat3 = (ES.dat_valName[0], [{&#39;date1&#39; : t1.isoformat()}, t2.isoformat(), t3.isoformat()])
dat3sn = (ES.dat_valName[0], [t1.isoformat(), t2.isoformat(), t3.isoformat()])
pdat3 = (ES.dat_valName[0], [pt1.isoformat(), pt2.isoformat(), pt3.isoformat()])
prop1 = (ES.prp_valName[0], prop_pm10)
prop2 = (ES.prp_valName[1], [prop_pm25, prop_pm10])
prop3 = (ES.prp_valName[0], [prop_pm25, prop_pm10, prop_co2])
pprop2 = (ES.prp_valName[0], [pprop_pm25, pprop_pm10])
loc1 = (ES.loc_valName[0], {&#39;paris&#39; : paris})
loc2 = (ES.loc_valName[0], [paris, lyon])
loc3 = (ES.loc_valName[0], [{&#39;paris&#39; : paris}, lyon, marseille])
loc3sn = (ES.loc_valName[0], [paris, lyon, marseille])
ploc3 = (ES.loc_valName[0], [pparis, plyon, pmarseille])
res2 = (ES.res_valName[0], [[41, [2, 2, 0]], [18, [1, 2, 1]]])

def option_simple(ob1):
    ob1.option[&#34;json_ESobs_class&#34;] = False
    ob1.option[&#34;json_prp_type&#34;] = False
    ob1.option[&#34;json_param&#34;] = True
    ob1.option[&#34;json_elt_type&#34;] = False
    ob1.option[&#34;json_obs_val&#34;] = True
    ob1.option[&#34;json_obs_attrib&#34;] = False
    ob1.option[&#34;json_res_index&#34;] = False
    ob1.option[&#34;json_info_type&#34;] = False
    ob1.option[&#34;json_info_nval&#34;] = False
    ob1.option[&#34;json_info_autre&#34;] = False
    ob1.option[&#34;json_info_box&#34;] = False

def majType_avec_option(ob1, maj_index):
    ob1.majType()
 
def envoi_mongo(ob):
    url = &#34;https://webhooks.mongodb-realm.com/api/client/v2.0/app/observation_app-wsjge/service/postObs/incoming_webhook/api?secret=10minutes&#34;
    r = rq.post(url, data=ob.json())  
    print(&#34;réponse : &#34;, r.text, &#34;\n&#34;)

simple = False

@unittest.skipIf(simple, &#34;test unitaire&#34;)
class TestObsUnitaire(unittest.TestCase):
    opt = ES.mOption.copy()
    def test_ResultValue(self):
        self.opt[&#34;json_res_index&#34;] = True
        self.assertEqual(ResultValue(&#34;coucou&#34;).json(self.opt), &#39;[&#34;coucou&#34;, [-1, -1, -1]]&#39;)
        self.assertEqual(ResultValue([&#34;coucou&#34;, [1, 2, -1]]).json(self.opt), &#39;[&#34;coucou&#34;, [1, 2, -1]]&#39;)
        self.assertEqual(ResultValue(&#34;coucou&#34;, [1, 2, -1]).json(self.opt), &#39;[&#34;coucou&#34;, [1, 2, -1]]&#39;)
        self.assertEqual(ResultValue(&#39;{&#34;er&#34;:2}&#39;, [1, 2, -1]).json(self.opt), &#39;[{&#34;er&#34;: 2}, [1, 2, -1]]&#39;)
        self.assertEqual(ResultValue(&#39;{&#34;er&#34;:2}&#39;).json(self.opt), &#39;[{&#34;er&#34;: 2}, [-1, -1, -1]]&#39;)
        self.assertEqual(ResultValue(&#39;[3,2]&#39;, [1, 2, -1]).json(self.opt), &#39;[&#34;[3, 2]&#34;, [1, 2, -1]]&#39;) 
        self.assertEqual(ResultValue(&#39;[3,2]&#39;).json(self.opt), &#39;[&#34;[3, 2]&#34;, [-1, -1, -1]]&#39;)
        self.assertEqual(ResultValue(21).json(self.opt), &#39;[21, [-1, -1, -1]]&#39;)
        self.assertEqual(ResultValue([23, [1, 2, -1]]).json(self.opt), &#39;[23, [1, 2, -1]]&#39;)
        self.assertEqual(ResultValue(23, [1, 2, -1]).json(self.opt), &#39;[23, [1, 2, -1]]&#39;)
        self.assertEqual(ResultValue(2.1).json(self.opt), &#39;[2.1, [-1, -1, -1]]&#39;)
        self.assertEqual(ResultValue([2.3, [1, 2, -1]]).json(self.opt), &#39;[2.3, [1, 2, -1]]&#39;) 
        self.opt[&#34;json_res_index&#34;] = False
        self.assertEqual(ResultValue(&#34;coucou&#34;).json(self.opt), &#39;&#34;coucou&#34;&#39;)
        self.assertEqual(ResultValue([&#34;coucou&#34;, [1, 2, -1]]).json(self.opt), &#39;&#34;coucou&#34;&#39;)
        self.assertEqual(ResultValue(&#39;{&#34;er&#34;:2}&#39;).json(self.opt), &#39;{&#34;er&#34;: 2}&#39;)
        self.assertEqual(ResultValue(&#39;[{&#34;er&#34;:2}, [1, 2, -1]]&#39;).json(self.opt), &#39;{&#34;er&#34;: 2}&#39;)
        self.assertEqual(ResultValue(22).json(self.opt), &#39;22&#39;)
        self.assertEqual(ResultValue([23, [1, 2, -1]]).json(self.opt), &#39;23&#39;)
        self.assertEqual(ResultValue(2.2).json(self.opt), &#39;2.2&#39;)
        self.assertEqual(ResultValue([2.3, [1, 2, -1]]).json(self.opt), &#39;2.3&#39;)
        self.opt[&#34;json_res_index&#34;] = True

    def test_locationValue(self):
        self.opt = ES.mOption.copy()
        self.assertEqual(LocationValue(lyon).json(self.opt), json.dumps(lyon)) 
        self.assertEqual(LocationValue(lyon), LocationValue(LocationValue(lyon)))
        self.assertEqual(ESValue.mini(LocationValue(lyon), LocationValue(paris)).json(self.opt), json.dumps(mini_PL))
        self.assertEqual(LocationValue(pol1).json(self.opt), json.dumps(pol1centre)) 
        self.opt[&#34;json_loc_point&#34;]=False 
        self.assertEqual(LocationValue(pol1).json(self.opt), json.dumps(pol1)) 
        
    def test_DatationValue(self):
        self.opt = ES.mOption.copy()
        self.assertEqual(DatationValue(t1), DatationValue(DatationValue(t1)))
        self.assertEqual(DatationValue(t1).json(self.opt), t1.isoformat()) 
        self.assertEqual(ESValue.maxi(DatationValue(t1), DatationValue(t2)).json(self.opt), t2.isoformat()) 
        self.opt[&#34;json_dat_instant&#34;] = False
        self.assertEqual(DatationValue(json.loads(t1n)).json(self.opt), t1.isoformat()) 
        self.opt[&#34;json_dat_name&#34;] = True
        self.opt[&#34;json_dat_instant&#34;] = True
        self.assertEqual(DatationValue(json.loads(t1n)).json(self.opt), t1n) 
        

    def test_propertyValue(self):
        self.opt = ES.mOption.copy()
        self.assertEqual(PropertyValue().json(self.opt), &#39;{}&#39;) 
        self.opt[&#34;json_prp_type&#34;] = False
        self.assertEqual(PropertyValue({ES.prp_propType : &#34;PM25&#34;}).json(self.opt), &#39;{&#34;&#39;+ES.prp_propType+&#39;&#34;: &#34;PM25&#34;}&#39;)
        self.assertEqual(PropertyValue(pprop_pm10).json(self.opt), json.dumps(pprop_pm10))
        self.opt[&#34;json_prp_type&#34;] = True
        self.assertEqual(PropertyValue(pprop_pm10).json(self.opt), 
                         json.dumps({list(pprop_pm10.keys())[0]: list(pprop_pm10.values())[0]}))
        
    def test_nameValue(self):
        self.assertEqual(DatationValue(&#39;recre&#39;).json(), tnull.isoformat()) 
        self.opt[&#34;json_dat_instant&#34;] = False
        self.opt[&#34;json_dat_name&#34;] = False
        self.assertEqual(DatationValue(&#39;recre&#39;).json(self.opt), tnull.isoformat())
        self.opt[&#34;json_prp_type&#34;] = False
        self.opt[&#34;json_prp_name&#34;] = True
        self.assertEqual(PropertyValue(pprop_pm25).json(self.opt), json.dumps(pprop_pm25))
        self.assertEqual(PropertyValue(&#39;test&#39;).json(self.opt), &#34;test&#34;)
        self.opt[&#34;json_loc_name&#34;] = True
        self.assertEqual(LocationValue(lyon).json(self.opt), json.dumps(lyon))
        self.assertEqual(LocationValue(&#39;test&#39;).json(self.opt), &#34;test&#34;)
        #ob1 = Observation(json.dumps(dict((obs_1, truc_mach, ndat3, loc3, prop2, res_(9)))))
        #option_simple(ob1)
        #ob1.option[&#34;json_loc_name&#34;] = True
        #self.assertEqual([&#39;loc0&#39;, &#39;loc1&#39;, &#39;loc2&#39;], json.loads(ob1.json())[ES.loc_valName[2]])
        
    def test_majValue_majName(self):
        val = LocationValue(lyon)
        val.majValue(LocationValue([4,5]), True)
        self.assertEqual(val.point, [4,5])
        val.majValue(LocationValue([[6,7], [7,8], [8,6]]), False)
        self.assertEqual(val.shap, gshape([[6,7], [7,8], [8,6]]))
        val.majName(&#39;truc&#39;)
        self.assertEqual(val.name, &#39;truc&#39;)     
        val = DatationValue(t1)
        val.majValue(DatationValue(t2), True)
        self.assertEqual(val.instant, t2)
        val.majValue(DatationValue(s1), False)
        self.assertEqual(val.slot, s1)
        val.majName(&#39;truc&#39;)
        self.assertEqual(val.name, &#39;truc&#39;)
    
    def test_ESSet(self):
        self.assertEqual(ESSet(DatationValue, [t1, t2, t3])[1], ESSet(DatationValue, [t1, t2, t3]).maxiBox()) 
        self.assertEqual(ESSet(LocationValue, [paris, lyon, marseille]).maxiBox(), LocationValue(maxi_PLM)) 
        self.assertEqual(ESSet(PropertyValue, [prop_pm10, prop_pm25]).jsonSet(self.opt), json.dumps([prop_pm10, prop_pm25])) 
        self.assertEqual(ESSet(LocationValue, [LocationValue(paris)]).maxiBox(), LocationValue(paris)) 

    def test_ESObs(self):
        da1 = ESSetDatation(Observation(), {ES.dat_valName[0]:[t1, t2, t3]})
        self.assertEqual(da1[1], da1.maxiBox()) 
        da2 = ESSetProperty(Observation(), {ES.prp_valName[0]:[prop_pm10, prop_pm25], ES.prp_upperValue :&#39;254&#39;})
        self.opt[&#34;json_prp_type&#34;] = False
        self.assertEqual(json.loads(&#39;{&#39;+da2.json(self.opt)+&#39;}&#39;)[ES.prp_valName[1]], [prop_pm10, prop_pm25]) 
        self.assertEqual(da2.mAtt[ES.prp_upperValue], &#39;254&#39;) 
        da3 = ESSetResult(Observation(), {ES.res_valName[0]:[r2, r2]})
        self.assertEqual(json.loads(&#39;{&#39;+da3.json(self.opt)+&#39;}&#39;)[ES.res_valName[0]], r2.value)
        da4 = ESSetLocation(Observation(), {ES.loc_valName[0]:[paris, lyon, marseille]})
        self.assertEqual(da4.maxiBox(), LocationValue(maxi_PLM)) 
        da5 = ESSetLocation(Observation(), {ES.loc_classES:{ES.loc_valName[0]:[paris, lyon, marseille], &#39;truc&#39;:&#39;machin&#39;}})
        self.assertEqual(da5.mAtt[&#39;truc&#39;], &#39;machin&#39;) 
        
    def test_ESElement(self):
        el = ESElement()
        el2 = ESElement()
        el2.setAtt(&#39;tric&#39;, &#39;meoc&#39;)
        el.setAtt(&#39;truc&#39;, &#39;mec&#39;)
        el.addComposant(el2)
        self.assertTrue(el.element(&#39;tric&#39;) == None)
        self.assertFalse(el.element(&#39;null&#39;) == None)

@unittest.skipIf(simple, &#34;test observation&#34;)
class TestBytes(unittest.TestCase):
    
    def test_location_bytes(self):
        #d5 = ESSetLocation(Observation(), {ES.loc_valName[2]:[&#34;paris&#34;, &#34;lyon&#34;, &#34;marseille&#34;]})
        d5 = ESSetLocation(Observation(), {ES.loc_valName[0]:[&#34;paris&#34;, &#34;lyon&#34;, &#34;marseille&#34;]})
        d4 = ESSetLocation(Observation())
        d4.from_bytes(d5.to_bytes(True))
        self.assertEqual(d4.valueList[2].name, &#34;marseille&#34;)
        d5 = ESSetLocation(Observation(), {ES.loc_valName[0]:[paris, lyon, marseille]})
        d4 = ESSetLocation(Observation())
        d4.from_bytes(d5.to_bytes())
        self.assertEqual(d4.valueList[2].point[0], marseille[0])

    def test_datation_bytes(self):
        #d5 = ESSetDatation(Observation(), {ES.dat_valName[2]:[&#34;t1&#34;, &#34;t2&#34;, &#34;t3&#34;]})
        d5 = ESSetDatation(Observation(), {ES.dat_valName[0]:[&#34;t1&#34;, &#34;t2&#34;, &#34;t3&#34;]})
        d4 = ESSetDatation(Observation())
        d4.from_bytes(d5.to_bytes(True))
        self.assertEqual(d4.valueList[2].name, &#34;t3&#34;)
        d5 = ESSetDatation(Observation(), {ES.dat_valName[0]:[t1, t2, t3]})
        d4 = ESSetDatation(Observation())
        d4.from_bytes(d5.to_bytes())
        self.assertEqual(d4.valueList[2].instant, t3)
        
    def test_property_bytes(self):
        da2 = ESSetProperty(Observation(), {ES.prp_valName[0]:[pprop_pm10, pprop_pm25]})
        da1 = ESSetProperty(Observation())
        da1.from_bytes(da2.to_bytes())
        self.assertEqual(da1.valueList[1].application, pprop_pm25[ES.prp_appli])

    def test_result_bytes(self):
        da3 = ESSetResult(Observation(), {ES.res_valName[0]:[r4, r5]})
        da2 = ESSetResult(Observation())
        da2.from_bytes(da3.to_bytes())
        self.assertEqual(da2.valueList[1].value, r5.value)
        da3 = ESSetResult(Observation(), {ES.res_valName[0]:[r6, r7]})
        da2 = ESSetResult(Observation())
        da2.from_bytes(da3.to_bytes(False, True))
        self.assertEqual(da2.valueList[0].value, r6.value)
        self.assertEqual(da2.valueList[0].ind, r6.ind)
        self.assertEqual(da2.valueList[1].value, r7.value)
        self.assertEqual(da2.valueList[1].ind, r7.ind)
        #ob2.option[&#34;json_res_index&#34;]=True
        da2 = ESSetResult(Observation())
        da2.from_bytes(da3.to_bytes(False, True, &#39;null&#39;, [&#39;CO2&#39;, &#39;CO2&#39;]), [&#39;CO2&#39;, &#39;CO2&#39;])
        self.assertEqual(da2.valueList[1].value, r7.value)
        da2 = ESSetResult(Observation())
        da2.from_bytes(da3.to_bytes(False, True, &#39;null&#39;, [&#39;CO2&#39;,&#39;PM25&#39;]), [&#39;CO2&#39;,&#39;PM25&#39;])
        self.assertEqual(round(da2.valueList[1].value, 1), round(r7.value, 1))
        da2 = ESSetResult(Observation())
        da2.from_bytes(da3.to_bytes(False, False, &#39;null&#39;, [&#39;CO2&#39;,&#39;PM25&#39;]), [&#39;CO2&#39;,&#39;PM25&#39;])
        self.assertEqual(round(da2.valueList[1].value, 1), round(r7.value, 1))
        
    def test_observation_bytes(self):
        ob1 = Observation(json.dumps(dict((obs_1, dat1, loc1, prop2, res_(2)))))
        ob2 = Observation()
        ob2.from_bytes(ob1.to_bytes())
        ob2.majType()
        self.assertEqual(ob1.to_bytes(), ob2.to_bytes())
        ob1 = Observation(json.dumps(dict((obs_1, dat1, loc1, prop1, res_(1)))))
        ob2 = Observation()
        ob2.from_bytes(ob1.to_bytes())
        ob2.majType()
        self.assertEqual(ob1.to_bytes(), ob2.to_bytes())
        ob1 = Observation(json.dumps(dict((obs_1, dat3, loc3, prop2, res2))))
        ob2 = Observation()
        ob2.from_bytes(ob1.to_bytes())
        ob2.majType()
        self.assertEqual(ob1.to_bytes(), ob2.to_bytes())
        ob2 = Observation()
        ob1.mAtt[ES.obs_reference] = 25
        ob1.option[&#39;bytes_res_format&#39;] = ob2.option[&#39;bytes_res_format&#39;] = &#39;uint32&#39;
        ob2.from_bytes(ob1.to_bytes())
        ob2.majType()
        self.assertEqual(ob1.to_bytes(), ob2.to_bytes())
        self.assertEqual(ob1.mAtt[ES.obs_reference], ob2.mAtt[ES.obs_reference])

@unittest.skipIf(simple, &#34;test observation&#34;)
class TestObservation(unittest.TestCase):

    def test_obs_vList(self):
        ob1 = Observation(dict((obs_1, truc_mach, dat3, loc3)))
        self.assertEqual(ob1.setDatation.vListName[0], &#39;date1&#39;)
        self.assertEqual(ob1.setDatation.vListName[1], &#39;dat1&#39;)
        self.assertEqual(ob1.setLocation.vListPoint, [paris, lyon, marseille])
        self.assertEqual(ob1.setDatation.vListInstant, [t1, t2, t3])
        ob1 = Observation(dict((obs_1, truc_mach, dat3, dpt2)))
        self.assertEqual(ob1.setLocation.vListPoint[0], pol1centre)

    def test_obs_simple(self):
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3))))
        option_simple(ob1)
        self.assertEqual(dict((obs_1, truc_mach, dat3sn)),    json.loads(ob1.json()))
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, loc3))))
        option_simple(ob1)
        self.assertEqual(dict((obs_1, truc_mach, loc3sn)),    json.loads(ob1.json()))
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, prop2))))
        option_simple(ob1)
        ob1.option[&#34;json_prp_type&#34;] = False
        self.assertEqual(dict((obs_1, truc_mach, prop2)),    json.loads(ob1.json()))
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, res_(9)))))
        option_simple(ob1)
        self.assertEqual(dict((obs_1, truc_mach, res_(9))),    json.loads(ob1.json()))
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(9)))))
        option_simple(ob1)
        self.assertEqual(dict((obs_1, truc_mach, dat3sn, loc3sn, prop2, res_(9))),json.loads(ob1.json()))
        
    def test_obs_att(self):
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, 
                                           (ES.obs_reference, 25), (ES.prp_upperValue,&#39;254&#39;),
                                           res_(9)))))
        self.assertEqual(ob1.mAtt[&#39;truc&#39;], &#39;machin&#39;)
        self.assertEqual(ob1.mAtt[ES.obs_reference], 25)
        self.assertEqual(ob1.setProperty.mAtt[ES.prp_upperValue], &#39;254&#39;)

    def test_obs_options(self):
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(9)))))
        option_simple(ob1)
        ob1.option[&#34;json_res_index&#34;] = True
        self.assertEqual(json.loads(ob1.json())[ES.res_valName[0]][0], [val_(9)[0], ES.nullInd])
        ob1.option[&#34;json_ESobs_class&#34;] = True
        self.assertTrue(ES.dat_classES in json.loads(ob1.json()))
        self.assertTrue(ES.res_classES in json.loads(ob1.json()))
        self.assertTrue(ES.loc_classES in json.loads(ob1.json()))
        self.assertTrue(ES.prp_classES in json.loads(ob1.json()))
        ob1.option[&#34;json_elt_type&#34;] = True
        self.assertTrue(ES.type + ES.dat_classES in json.loads(ob1.json())[ES.dat_classES])
        self.assertTrue(ES.type + ES.res_classES in json.loads(ob1.json())[ES.res_classES])
        self.assertTrue(ES.type + ES.loc_classES in json.loads(ob1.json())[ES.loc_classES])
        self.assertTrue(ES.type + ES.prp_classES in json.loads(ob1.json())[ES.prp_classES])
        ob1.option[&#34;json_obs_val&#34;] = False
        self.assertTrue(ES.dat_classES in json.loads(&#39;{&#39; + ob1.json() + &#39;}&#39;))
        ob1.option[&#34;json_obs_val&#34;] = True
        ob1.option[&#34;json_obs_attrib&#34;] = True
        self.assertTrue(ES.obs_attributes in json.loads(ob1.json()))
        ob1.option[&#34;json_info_type&#34;] = True
        ob1.option[&#34;json_info_nval&#34;] = True
        ob1.option[&#34;json_info_autre&#34;] = True
        ob1.option[&#34;json_info_box&#34;] = True
        ob2 = Observation(ob1.json())
        self.assertTrue(ES.type in json.loads(ob2.json()))
        
    def test_obs_maj_type(self):
        maj = [False, True]
        for maj_index in maj:
            ob = Observation()
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 0 and not ob.complet )
            ob = Observation(json.dumps(dict((obs_1, dat1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 1 and not ob.complet )
            ob = Observation(json.dumps(dict((obs_1, dat3))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 2 and not ob.complet )
            ob = Observation(json.dumps(dict((obs_1, loc1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 10 and not ob.complet)
            ob = Observation(json.dumps(dict((obs_1, loc1, dat1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 11 and not ob.complet)
            ob = Observation(json.dumps(dict((obs_1, loc1, dat3))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 12 and not ob.complet)
            ob = Observation(json.dumps(dict((obs_1, loc3))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 20 and not ob.complet)
            ob = Observation(json.dumps(dict((obs_1, loc3, dat1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 21 and not ob.complet)
            ob = Observation(json.dumps(dict((obs_1, loc3, dat3))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 22 and not ob.complet)
            ob = Observation(json.dumps(dict((obs_1, res_(1)))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 0 and ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), dat1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 1 and ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), dat3))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 2 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), loc1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 10 and ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), loc1, dat1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 11 and ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), loc1, dat3))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 12 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), loc3))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 20 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), loc3, dat1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 21 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), loc3, dat3))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 22 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), loc3, dat2))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 22 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(9)))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 0 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(9), dat1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 1 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(3), dat3, prop1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 102 and ob.complet and ob.setResult.axes == [0])
            ob = Observation(json.dumps(dict((obs_1, res_(6), dat3, prop1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 102 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(3), loc1, prop1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 110 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(3), loc1, dat1, prop1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 111 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(3), loc1, dat3, prop1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 112 and ob.complet and ob.setResult.axes == [0])
            ob = Observation(json.dumps(dict((obs_1, res_(6), loc1, dat3, prop1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 112 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(6), loc3, prop2))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 220 and ob.complet and ob.setResult.axes == [1, 2])
            ob = Observation(json.dumps(dict((obs_1, res_(9), loc3, prop2))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 220 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(9), loc3, dat1, prop2))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 221 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(6), loc3, dat1, prop2))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 224 and ob.complet and ob.setResult.axes == [1, 2])
            ob = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18)))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 228 and ob.complet and ob.setResult.axes == [0, 1, 2])
            ob = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(9)))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 222 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, dat3, loc3, prop2, res_(6)))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 225 and ob.complet and ob.setResult.axes == [10, 2])
            #envoi_mongo(ob)
            #ob.option[&#34;json_res_index&#34;] = True
            #print(ob.json(), &#39;\n&#39;)

    def test_obs_dim(self):
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat2, loc3, prop3, res_(6)))),&#39;xd&#39;)
        self.assertTrue(ob1.score == 227 and ob1.complet and ob1.setResult.axes == [0, 21])
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc2, prop3, res_(6)))),&#39;lx&#39;)
        self.assertTrue(ob1.score == 226 and ob1.complet and ob1.setResult.axes == [20, 1])
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop3, res_(3)))),&#39;x&#39;)
        self.assertTrue(ob1.score == 222 and ob1.complet and ob1.setResult.axes == [120])

    def test_obs_majListName_majListValue(self):
        ob1 = Observation(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18))))
        ob1.majList(LocationValue, [pparis, plyon, pmarseille], &#39;base&#39;)
        self.assertEqual(ob1.setLocation.valueList[2].point, pmarseille)
        ob1.majList(DatationValue, [pt1, pt2, pt3], &#39;base&#39;)
        self.assertEqual(ob1.setDatation.valueList[2].instant, pt3)
        ob1.majList(LocationValue, [&#39;paris&#39;, &#39;lyon&#39;, &#39;marseille&#39;], &#39;name&#39;)
        self.assertEqual(ob1.setLocation.valueList[2].name, &#39;marseille&#39;)

    def test_obs_majIndex_iloc(self):
        ob1 = Observation(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18))))
        self.assertEqual(ob1.iloc(0,0,1)[ES.res_classES], &#39;1&#39;)
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18)))),&#39;lpd&#39;)
        self.assertEqual(ob1.iloc(0,0,1)[ES.res_classES], &#39;3&#39;)
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18)))),&#39;pdl&#39;)
        self.assertEqual(ob1.iloc(0,0,1)[ES.res_classES], &#39;9&#39;)
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(6)))),&#39;xp&#39;)
        self.assertEqual(ob1.iloc(0,0,1)[ES.res_classES], &#39;1&#39;)
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(6)))),&#39;px&#39;)
        self.assertEqual(ob1.iloc(0,0,1)[ES.res_classES], &#39;3&#39;)
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat2, loc3, prop3, res_(6)))),&#39;xd&#39;)
        self.assertEqual(ob1.iloc(0,1,1)[ES.res_classES], &#39;2&#39;)
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc2, prop3, res_(6)))),&#39;lx&#39;)
        self.assertEqual(ob1.iloc(0,1,0)[ES.res_classES], &#39;3&#39;)
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop3, res_(3)))),&#39;x&#39;)
        self.assertEqual(ob1.iloc(1,1,1)[ES.res_classES], &#39;1&#39;)

    def test_obs_sort(self):
        ob = Observation(dict((obs_1, dat3, dpt3, prop2, res_(6))), &#39;px&#39;)
        test = ob.iloc(1,1,0)
        ob.sort(cross = False)
        self.assertEqual(ob.iloc(2,1,1), test)
        ob.sort()
        self.assertEqual(ob.iloc(2,2,1), test)
        ob.sort(cross = False, order = [1,0,2])
        self.assertEqual(ob.iloc(2,1,1), test)
        ob.sort(order = [1,0,2])
        self.assertEqual(ob.iloc(1,1,1), test)
        
    def test_obs_creation(self):
        obs1 = Observation()
        self.assertEqual(obs1.classES,                   ES.obs_classES)
        self.assertEqual(ESSetDatation(obs1).classES,    ES.dat_classES)
        self.assertEqual(ESSetResult(obs1).classES,      ES.res_classES)
        self.assertEqual(ESSetProperty(obs1).classES,    ES.prp_classES)
        self.assertEqual(ESSetLocation(obs1).classES,    ES.loc_classES)
      
        ob = Observation(json.dumps(dict([obs_1, res_(9)])))
        self.assertEqual(json.loads(ob.json())[ES.res_valName[0]], val_(9))

    def test_obs_add(self):
        ob = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18)))))
        ob.option[&#34;json_prp_type&#34;] = False
        ob.option[&#34;json_loc_name&#34;] = ob.option[&#34;json_dat_name&#34;] = ob.option[&#34;json_prp_name&#34;] = True
        obp = Observation(json.dumps(dict((obs_1, truc_mach, pdat3, ploc3, pprop2, res_(18)))))
        obp.option[&#34;json_prp_type&#34;] = False
        obp.option[&#34;json_loc_name&#34;] = obp.option[&#34;json_dat_name&#34;] = obp.option[&#34;json_prp_name&#34;] = True
        obc = copy(ob)
        obc.option[&#34;json_prp_type&#34;] = False
        obc.option[&#34;json_loc_name&#34;] = obc.option[&#34;json_dat_name&#34;] = obc.option[&#34;json_prp_name&#34;] = True
        obc += ob
        self.assertEqual(json.loads(ob.json())[ES.res_valName[0]], json.loads(obc.json())[ES.res_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.dat_valName[0]], json.loads(obc.json())[ES.dat_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]], json.loads(obc.json())[ES.loc_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.prp_valName[1]], json.loads(obc.json())[ES.prp_valName[1]])
        ob2 = ob + ob
        self.assertEqual(json.loads(ob.json())[ES.res_valName[0]], json.loads(ob2.json())[ES.res_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.dat_valName[0]], json.loads(ob2.json())[ES.dat_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]], json.loads(ob2.json())[ES.loc_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.prp_valName[1]], json.loads(ob2.json())[ES.prp_valName[1]])
        obc = copy(ob)
        obc += obp
        self.assertEqual(json.loads(ob.json())[ES.res_valName[0]] + json.loads(obp.json())[ES.res_valName[0]], 
                         json.loads(obc.json())[ES.res_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.dat_valName[0]] + json.loads(obp.json())[ES.dat_valName[0]],
                         json.loads(obc.json())[ES.dat_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]] + json.loads(obp.json())[ES.loc_valName[0]],
                         json.loads(obc.json())[ES.loc_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.prp_valName[1]] + json.loads(obp.json())[ES.prp_valName[1]],
                         json.loads(obc.json())[ES.prp_valName[1]])
        ob2 = ob + obp
        self.assertEqual(json.loads(ob.json())[ES.res_valName[0]] + json.loads(obp.json())[ES.res_valName[0]], 
                         json.loads(ob2.json())[ES.res_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.dat_valName[0]] + json.loads(obp.json())[ES.dat_valName[0]],
                         json.loads(ob2.json())[ES.dat_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]] + json.loads(obp.json())[ES.loc_valName[0]],
                         json.loads(ob2.json())[ES.loc_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.prp_valName[1]] + json.loads(obp.json())[ES.prp_valName[1]],
                         json.loads(ob2.json())[ES.prp_valName[1]])
        obp2 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, pprop2, res_(18)))))
        obp2.option[&#34;json_prp_type&#34;] = False
        ob2 = ob + obp2
        self.assertEqual(json.loads(ob.json())[ES.res_valName[0]] + json.loads(obp.json())[ES.res_valName[0]], 
                         json.loads(ob2.json())[ES.res_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.dat_valName[0]], json.loads(ob2.json())[ES.dat_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]], json.loads(ob2.json())[ES.loc_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.prp_valName[1]] + json.loads(obp2.json())[ES.prp_valName[1]],
                         json.loads(ob2.json())[ES.prp_valName[1]])

    def test_obs_extend(self):
        ob = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2))))
        obp = Observation(json.dumps(dict((obs_1, res_(18)))))
        ob.extend(obp)
        self.assertEqual(json.loads(ob.json())[ES.res_valName[0]], json.loads(obp.json())[ES.res_valName[0]])
        ob = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2))))
        obp = Observation(json.dumps(dict((obs_1, ploc3, res_(18)))))
        obc = copy(ob)
        ob.extend(obp)
        self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]], json.loads(obc.json())[ES.loc_valName[0]])

    def test_sensor(self):
        obs = Observation()
        nprop1 = obs.addValue(PropertyValue(prop_pm25))
        for i in range(6): # simule une boucle de mesure
            nres = obs.addValueSensor(ResultValue(45+i), 
                                DatationValue(datetime(2021, 6, 4+i, 12, 5).isoformat()),
                                LocationValue([14+i, 40]),
                                nprop1)
        obs.majType()
        obs.option[&#34;json_ESobs_class&#34;] = True
        obs.option[&#34;json_elt_type&#34;] = True
        self.assertEqual(json.loads(obs.json())[ES.information][&#34;typeobs&#34;], ES.obsCat[122])
        
    def test_geo_interface(self):
        ob = Observation(json.dumps(dict([obs_1, loc3])))
        res_loc = (tuple(paris), tuple(lyon), tuple(marseille))
        res_geo = dict([(ES.type,&#34;MultiPoint&#34;), (&#34;coordinates&#34;,res_loc)])
        self.assertEqual(ob.__geo_interface__, res_geo)
        self.assertEqual(ob.__geo_interface__[&#34;coordinates&#34;], res_loc)
        ob.option[&#34;json_loc_point&#34;] = False
        self.assertEqual(ob.__geo_interface__, res_geo)
        ob = Observation(json.dumps(dict((obs_1, dpt2, dat1))))
        dpt2pt = {&#39;type&#39;: &#39;MultiPoint&#39;, &#39;coordinates&#39;: ((0.666667, 1.333333), (1.0, 1.666667))}
        self.assertEqual(ob.__geo_interface__, dpt2pt)
        ob.option[&#34;json_loc_point&#34;] = False
        dpt2pol = {&#39;type&#39;: &#39;MultiPolygon&#39;, &#39;coordinates&#39;: [(((0.0, 1.0), (1.0, 2.0), (1.0, 1.0), (0.0, 1.0)),),
                                                           (((0.0, 2.0), (2.0, 2.0), (1.0, 1.0), (0.0, 2.0)),)]}
        self.assertEqual(ob.__geo_interface__, dpt2pol)

    def test_obs_polygon(self):
        ob = Observation(json.dumps(dict((obs_1, dat3, dpt2, prop2, res_(6)))))
        ob.option[&#34;json_loc_point&#34;] = False
        self.assertEqual(json.dumps(ob.__geo_interface__), 
                         json.dumps({&#34;type&#34;: &#34;MultiPolygon&#34;, &#34;coordinates&#34;: dpt2[1]}))
        
    def test_xarray(self):
        ob = Observation(dict((obs_1, dat3, loc3, prop2, res_(6))), &#39;xp&#39;)
        self.assertTrue(ob.to_xarray()[2,1].item() == ResultValue(2))
        ob = Observation(dict((obs_1, dat3, loc3, prop1, res_(3))), &#39;xp&#39;)
        self.assertTrue(ob.to_xarray()[1].item() == ResultValue(2))
        ob = Observation(dict((obs_1, dat3, loc3, prop3, res_(3))), &#39;dlp&#39;)
        self.assertTrue(ob.to_xarray()[1].item() == ResultValue(2))
        ob = Observation(dict((obs_1, dat3, loc3, prop2, res_(18))), &#39;dlp&#39;)
        self.assertTrue(ob.to_xarray()[2,1,0].item() == ResultValue(9))
        ob = Observation(dict((obs_1, dat3, loc2, prop1, res_(6))), &#39;dlp&#39;)
        self.assertTrue(ob.to_xarray()[2,0].item() == ResultValue(2))
        
    def test_exports(self):
        ob = Observation(json.dumps(dict((obs_1, dat3, dpt3, prop1, res_(3)))), &#39;px&#39;)
        #ob.majType()
        #self.assertTrue(type(ob.to_xarray()) != type(None))
        #self.assertTrue(type(ob.to_dataFrame()) != type(None))
        #self.assertTrue(ob.choropleth() != None)
        #self.assertTrue(type(ob.to_geoDataFrame()) != type(None))
        self.assertTrue(ob.jsonFeature != &#39;&#39;)


if __name__ == &#39;__main__&#39;:
    unittest.main(verbosity=2)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="ES.EStestunitaire.envoi_mongo"><code class="name flex">
<span>def <span class="ident">envoi_mongo</span></span>(<span>ob)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def envoi_mongo(ob):
    url = &#34;https://webhooks.mongodb-realm.com/api/client/v2.0/app/observation_app-wsjge/service/postObs/incoming_webhook/api?secret=10minutes&#34;
    r = rq.post(url, data=ob.json())  
    print(&#34;réponse : &#34;, r.text, &#34;\n&#34;)</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.majType_avec_option"><code class="name flex">
<span>def <span class="ident">majType_avec_option</span></span>(<span>ob1, maj_index)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def majType_avec_option(ob1, maj_index):
    ob1.majType()</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.option_simple"><code class="name flex">
<span>def <span class="ident">option_simple</span></span>(<span>ob1)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def option_simple(ob1):
    ob1.option[&#34;json_ESobs_class&#34;] = False
    ob1.option[&#34;json_prp_type&#34;] = False
    ob1.option[&#34;json_param&#34;] = True
    ob1.option[&#34;json_elt_type&#34;] = False
    ob1.option[&#34;json_obs_val&#34;] = True
    ob1.option[&#34;json_obs_attrib&#34;] = False
    ob1.option[&#34;json_res_index&#34;] = False
    ob1.option[&#34;json_info_type&#34;] = False
    ob1.option[&#34;json_info_nval&#34;] = False
    ob1.option[&#34;json_info_autre&#34;] = False
    ob1.option[&#34;json_info_box&#34;] = False</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.res_"><code class="name flex">
<span>def <span class="ident">res_</span></span>(<span>n)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def res_(n): return (ES.res_valName[0], val_(n))</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.val_"><code class="name flex">
<span>def <span class="ident">val_</span></span>(<span>n)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def val_(n): return list(i for i in range(n))</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="ES.EStestunitaire.TestBytes"><code class="flex name class">
<span>class <span class="ident">TestBytes</span></span>
<span>(</span><span>methodName='runTest')</span>
</code></dt>
<dd>
<div class="desc"><p>A class whose instances are single test cases.</p>
<p>By default, the test code itself should be placed in a method named
'runTest'.</p>
<p>If the fixture may be used for many test cases, create as
many test methods as are needed. When instantiating such a TestCase
subclass, specify in the constructor arguments the name of the test method
that the instance is to execute.</p>
<p>Test authors should subclass TestCase for their own tests. Construction
and deconstruction of the test's environment ('fixture') can be
implemented by overriding the 'setUp' and 'tearDown' methods respectively.</p>
<p>If it is necessary to override the <strong>init</strong> method, the base class
<strong>init</strong> method must always be called. It is important that subclasses
should not change the signature of their <strong>init</strong> method, since instances
of the classes are instantiated automatically by parts of the framework
in order to be run.</p>
<p>When subclassing TestCase, you can set these attributes:
* failureException: determines which exception will be raised when
the instance's assertion methods fail; test methods raising this
exception will be deemed to have 'failed' rather than 'errored'.
* longMessage: determines whether long messages (including repr of
objects used in assert methods) will be printed on failure in <em>addition</em>
to any explicit message passed.
* maxDiff: sets the maximum length of a diff in failure messages
by assert methods using difflib. It is looked up as an instance
attribute so can be configured by individual tests if required.</p>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@unittest.skipIf(simple, &#34;test observation&#34;)
class TestBytes(unittest.TestCase):
    
    def test_location_bytes(self):
        #d5 = ESSetLocation(Observation(), {ES.loc_valName[2]:[&#34;paris&#34;, &#34;lyon&#34;, &#34;marseille&#34;]})
        d5 = ESSetLocation(Observation(), {ES.loc_valName[0]:[&#34;paris&#34;, &#34;lyon&#34;, &#34;marseille&#34;]})
        d4 = ESSetLocation(Observation())
        d4.from_bytes(d5.to_bytes(True))
        self.assertEqual(d4.valueList[2].name, &#34;marseille&#34;)
        d5 = ESSetLocation(Observation(), {ES.loc_valName[0]:[paris, lyon, marseille]})
        d4 = ESSetLocation(Observation())
        d4.from_bytes(d5.to_bytes())
        self.assertEqual(d4.valueList[2].point[0], marseille[0])

    def test_datation_bytes(self):
        #d5 = ESSetDatation(Observation(), {ES.dat_valName[2]:[&#34;t1&#34;, &#34;t2&#34;, &#34;t3&#34;]})
        d5 = ESSetDatation(Observation(), {ES.dat_valName[0]:[&#34;t1&#34;, &#34;t2&#34;, &#34;t3&#34;]})
        d4 = ESSetDatation(Observation())
        d4.from_bytes(d5.to_bytes(True))
        self.assertEqual(d4.valueList[2].name, &#34;t3&#34;)
        d5 = ESSetDatation(Observation(), {ES.dat_valName[0]:[t1, t2, t3]})
        d4 = ESSetDatation(Observation())
        d4.from_bytes(d5.to_bytes())
        self.assertEqual(d4.valueList[2].instant, t3)
        
    def test_property_bytes(self):
        da2 = ESSetProperty(Observation(), {ES.prp_valName[0]:[pprop_pm10, pprop_pm25]})
        da1 = ESSetProperty(Observation())
        da1.from_bytes(da2.to_bytes())
        self.assertEqual(da1.valueList[1].application, pprop_pm25[ES.prp_appli])

    def test_result_bytes(self):
        da3 = ESSetResult(Observation(), {ES.res_valName[0]:[r4, r5]})
        da2 = ESSetResult(Observation())
        da2.from_bytes(da3.to_bytes())
        self.assertEqual(da2.valueList[1].value, r5.value)
        da3 = ESSetResult(Observation(), {ES.res_valName[0]:[r6, r7]})
        da2 = ESSetResult(Observation())
        da2.from_bytes(da3.to_bytes(False, True))
        self.assertEqual(da2.valueList[0].value, r6.value)
        self.assertEqual(da2.valueList[0].ind, r6.ind)
        self.assertEqual(da2.valueList[1].value, r7.value)
        self.assertEqual(da2.valueList[1].ind, r7.ind)
        #ob2.option[&#34;json_res_index&#34;]=True
        da2 = ESSetResult(Observation())
        da2.from_bytes(da3.to_bytes(False, True, &#39;null&#39;, [&#39;CO2&#39;, &#39;CO2&#39;]), [&#39;CO2&#39;, &#39;CO2&#39;])
        self.assertEqual(da2.valueList[1].value, r7.value)
        da2 = ESSetResult(Observation())
        da2.from_bytes(da3.to_bytes(False, True, &#39;null&#39;, [&#39;CO2&#39;,&#39;PM25&#39;]), [&#39;CO2&#39;,&#39;PM25&#39;])
        self.assertEqual(round(da2.valueList[1].value, 1), round(r7.value, 1))
        da2 = ESSetResult(Observation())
        da2.from_bytes(da3.to_bytes(False, False, &#39;null&#39;, [&#39;CO2&#39;,&#39;PM25&#39;]), [&#39;CO2&#39;,&#39;PM25&#39;])
        self.assertEqual(round(da2.valueList[1].value, 1), round(r7.value, 1))
        
    def test_observation_bytes(self):
        ob1 = Observation(json.dumps(dict((obs_1, dat1, loc1, prop2, res_(2)))))
        ob2 = Observation()
        ob2.from_bytes(ob1.to_bytes())
        ob2.majType()
        self.assertEqual(ob1.to_bytes(), ob2.to_bytes())
        ob1 = Observation(json.dumps(dict((obs_1, dat1, loc1, prop1, res_(1)))))
        ob2 = Observation()
        ob2.from_bytes(ob1.to_bytes())
        ob2.majType()
        self.assertEqual(ob1.to_bytes(), ob2.to_bytes())
        ob1 = Observation(json.dumps(dict((obs_1, dat3, loc3, prop2, res2))))
        ob2 = Observation()
        ob2.from_bytes(ob1.to_bytes())
        ob2.majType()
        self.assertEqual(ob1.to_bytes(), ob2.to_bytes())
        ob2 = Observation()
        ob1.mAtt[ES.obs_reference] = 25
        ob1.option[&#39;bytes_res_format&#39;] = ob2.option[&#39;bytes_res_format&#39;] = &#39;uint32&#39;
        ob2.from_bytes(ob1.to_bytes())
        ob2.majType()
        self.assertEqual(ob1.to_bytes(), ob2.to_bytes())
        self.assertEqual(ob1.mAtt[ES.obs_reference], ob2.mAtt[ES.obs_reference])</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>unittest.case.TestCase</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="ES.EStestunitaire.TestBytes.test_datation_bytes"><code class="name flex">
<span>def <span class="ident">test_datation_bytes</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_datation_bytes(self):
    #d5 = ESSetDatation(Observation(), {ES.dat_valName[2]:[&#34;t1&#34;, &#34;t2&#34;, &#34;t3&#34;]})
    d5 = ESSetDatation(Observation(), {ES.dat_valName[0]:[&#34;t1&#34;, &#34;t2&#34;, &#34;t3&#34;]})
    d4 = ESSetDatation(Observation())
    d4.from_bytes(d5.to_bytes(True))
    self.assertEqual(d4.valueList[2].name, &#34;t3&#34;)
    d5 = ESSetDatation(Observation(), {ES.dat_valName[0]:[t1, t2, t3]})
    d4 = ESSetDatation(Observation())
    d4.from_bytes(d5.to_bytes())
    self.assertEqual(d4.valueList[2].instant, t3)</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestBytes.test_location_bytes"><code class="name flex">
<span>def <span class="ident">test_location_bytes</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_location_bytes(self):
    #d5 = ESSetLocation(Observation(), {ES.loc_valName[2]:[&#34;paris&#34;, &#34;lyon&#34;, &#34;marseille&#34;]})
    d5 = ESSetLocation(Observation(), {ES.loc_valName[0]:[&#34;paris&#34;, &#34;lyon&#34;, &#34;marseille&#34;]})
    d4 = ESSetLocation(Observation())
    d4.from_bytes(d5.to_bytes(True))
    self.assertEqual(d4.valueList[2].name, &#34;marseille&#34;)
    d5 = ESSetLocation(Observation(), {ES.loc_valName[0]:[paris, lyon, marseille]})
    d4 = ESSetLocation(Observation())
    d4.from_bytes(d5.to_bytes())
    self.assertEqual(d4.valueList[2].point[0], marseille[0])</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestBytes.test_observation_bytes"><code class="name flex">
<span>def <span class="ident">test_observation_bytes</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_observation_bytes(self):
    ob1 = Observation(json.dumps(dict((obs_1, dat1, loc1, prop2, res_(2)))))
    ob2 = Observation()
    ob2.from_bytes(ob1.to_bytes())
    ob2.majType()
    self.assertEqual(ob1.to_bytes(), ob2.to_bytes())
    ob1 = Observation(json.dumps(dict((obs_1, dat1, loc1, prop1, res_(1)))))
    ob2 = Observation()
    ob2.from_bytes(ob1.to_bytes())
    ob2.majType()
    self.assertEqual(ob1.to_bytes(), ob2.to_bytes())
    ob1 = Observation(json.dumps(dict((obs_1, dat3, loc3, prop2, res2))))
    ob2 = Observation()
    ob2.from_bytes(ob1.to_bytes())
    ob2.majType()
    self.assertEqual(ob1.to_bytes(), ob2.to_bytes())
    ob2 = Observation()
    ob1.mAtt[ES.obs_reference] = 25
    ob1.option[&#39;bytes_res_format&#39;] = ob2.option[&#39;bytes_res_format&#39;] = &#39;uint32&#39;
    ob2.from_bytes(ob1.to_bytes())
    ob2.majType()
    self.assertEqual(ob1.to_bytes(), ob2.to_bytes())
    self.assertEqual(ob1.mAtt[ES.obs_reference], ob2.mAtt[ES.obs_reference])</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestBytes.test_property_bytes"><code class="name flex">
<span>def <span class="ident">test_property_bytes</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_property_bytes(self):
    da2 = ESSetProperty(Observation(), {ES.prp_valName[0]:[pprop_pm10, pprop_pm25]})
    da1 = ESSetProperty(Observation())
    da1.from_bytes(da2.to_bytes())
    self.assertEqual(da1.valueList[1].application, pprop_pm25[ES.prp_appli])</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestBytes.test_result_bytes"><code class="name flex">
<span>def <span class="ident">test_result_bytes</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_result_bytes(self):
    da3 = ESSetResult(Observation(), {ES.res_valName[0]:[r4, r5]})
    da2 = ESSetResult(Observation())
    da2.from_bytes(da3.to_bytes())
    self.assertEqual(da2.valueList[1].value, r5.value)
    da3 = ESSetResult(Observation(), {ES.res_valName[0]:[r6, r7]})
    da2 = ESSetResult(Observation())
    da2.from_bytes(da3.to_bytes(False, True))
    self.assertEqual(da2.valueList[0].value, r6.value)
    self.assertEqual(da2.valueList[0].ind, r6.ind)
    self.assertEqual(da2.valueList[1].value, r7.value)
    self.assertEqual(da2.valueList[1].ind, r7.ind)
    #ob2.option[&#34;json_res_index&#34;]=True
    da2 = ESSetResult(Observation())
    da2.from_bytes(da3.to_bytes(False, True, &#39;null&#39;, [&#39;CO2&#39;, &#39;CO2&#39;]), [&#39;CO2&#39;, &#39;CO2&#39;])
    self.assertEqual(da2.valueList[1].value, r7.value)
    da2 = ESSetResult(Observation())
    da2.from_bytes(da3.to_bytes(False, True, &#39;null&#39;, [&#39;CO2&#39;,&#39;PM25&#39;]), [&#39;CO2&#39;,&#39;PM25&#39;])
    self.assertEqual(round(da2.valueList[1].value, 1), round(r7.value, 1))
    da2 = ESSetResult(Observation())
    da2.from_bytes(da3.to_bytes(False, False, &#39;null&#39;, [&#39;CO2&#39;,&#39;PM25&#39;]), [&#39;CO2&#39;,&#39;PM25&#39;])
    self.assertEqual(round(da2.valueList[1].value, 1), round(r7.value, 1))</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="ES.EStestunitaire.TestObsUnitaire"><code class="flex name class">
<span>class <span class="ident">TestObsUnitaire</span></span>
<span>(</span><span>methodName='runTest')</span>
</code></dt>
<dd>
<div class="desc"><p>A class whose instances are single test cases.</p>
<p>By default, the test code itself should be placed in a method named
'runTest'.</p>
<p>If the fixture may be used for many test cases, create as
many test methods as are needed. When instantiating such a TestCase
subclass, specify in the constructor arguments the name of the test method
that the instance is to execute.</p>
<p>Test authors should subclass TestCase for their own tests. Construction
and deconstruction of the test's environment ('fixture') can be
implemented by overriding the 'setUp' and 'tearDown' methods respectively.</p>
<p>If it is necessary to override the <strong>init</strong> method, the base class
<strong>init</strong> method must always be called. It is important that subclasses
should not change the signature of their <strong>init</strong> method, since instances
of the classes are instantiated automatically by parts of the framework
in order to be run.</p>
<p>When subclassing TestCase, you can set these attributes:
* failureException: determines which exception will be raised when
the instance's assertion methods fail; test methods raising this
exception will be deemed to have 'failed' rather than 'errored'.
* longMessage: determines whether long messages (including repr of
objects used in assert methods) will be printed on failure in <em>addition</em>
to any explicit message passed.
* maxDiff: sets the maximum length of a diff in failure messages
by assert methods using difflib. It is looked up as an instance
attribute so can be configured by individual tests if required.</p>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@unittest.skipIf(simple, &#34;test unitaire&#34;)
class TestObsUnitaire(unittest.TestCase):
    opt = ES.mOption.copy()
    def test_ResultValue(self):
        self.opt[&#34;json_res_index&#34;] = True
        self.assertEqual(ResultValue(&#34;coucou&#34;).json(self.opt), &#39;[&#34;coucou&#34;, [-1, -1, -1]]&#39;)
        self.assertEqual(ResultValue([&#34;coucou&#34;, [1, 2, -1]]).json(self.opt), &#39;[&#34;coucou&#34;, [1, 2, -1]]&#39;)
        self.assertEqual(ResultValue(&#34;coucou&#34;, [1, 2, -1]).json(self.opt), &#39;[&#34;coucou&#34;, [1, 2, -1]]&#39;)
        self.assertEqual(ResultValue(&#39;{&#34;er&#34;:2}&#39;, [1, 2, -1]).json(self.opt), &#39;[{&#34;er&#34;: 2}, [1, 2, -1]]&#39;)
        self.assertEqual(ResultValue(&#39;{&#34;er&#34;:2}&#39;).json(self.opt), &#39;[{&#34;er&#34;: 2}, [-1, -1, -1]]&#39;)
        self.assertEqual(ResultValue(&#39;[3,2]&#39;, [1, 2, -1]).json(self.opt), &#39;[&#34;[3, 2]&#34;, [1, 2, -1]]&#39;) 
        self.assertEqual(ResultValue(&#39;[3,2]&#39;).json(self.opt), &#39;[&#34;[3, 2]&#34;, [-1, -1, -1]]&#39;)
        self.assertEqual(ResultValue(21).json(self.opt), &#39;[21, [-1, -1, -1]]&#39;)
        self.assertEqual(ResultValue([23, [1, 2, -1]]).json(self.opt), &#39;[23, [1, 2, -1]]&#39;)
        self.assertEqual(ResultValue(23, [1, 2, -1]).json(self.opt), &#39;[23, [1, 2, -1]]&#39;)
        self.assertEqual(ResultValue(2.1).json(self.opt), &#39;[2.1, [-1, -1, -1]]&#39;)
        self.assertEqual(ResultValue([2.3, [1, 2, -1]]).json(self.opt), &#39;[2.3, [1, 2, -1]]&#39;) 
        self.opt[&#34;json_res_index&#34;] = False
        self.assertEqual(ResultValue(&#34;coucou&#34;).json(self.opt), &#39;&#34;coucou&#34;&#39;)
        self.assertEqual(ResultValue([&#34;coucou&#34;, [1, 2, -1]]).json(self.opt), &#39;&#34;coucou&#34;&#39;)
        self.assertEqual(ResultValue(&#39;{&#34;er&#34;:2}&#39;).json(self.opt), &#39;{&#34;er&#34;: 2}&#39;)
        self.assertEqual(ResultValue(&#39;[{&#34;er&#34;:2}, [1, 2, -1]]&#39;).json(self.opt), &#39;{&#34;er&#34;: 2}&#39;)
        self.assertEqual(ResultValue(22).json(self.opt), &#39;22&#39;)
        self.assertEqual(ResultValue([23, [1, 2, -1]]).json(self.opt), &#39;23&#39;)
        self.assertEqual(ResultValue(2.2).json(self.opt), &#39;2.2&#39;)
        self.assertEqual(ResultValue([2.3, [1, 2, -1]]).json(self.opt), &#39;2.3&#39;)
        self.opt[&#34;json_res_index&#34;] = True

    def test_locationValue(self):
        self.opt = ES.mOption.copy()
        self.assertEqual(LocationValue(lyon).json(self.opt), json.dumps(lyon)) 
        self.assertEqual(LocationValue(lyon), LocationValue(LocationValue(lyon)))
        self.assertEqual(ESValue.mini(LocationValue(lyon), LocationValue(paris)).json(self.opt), json.dumps(mini_PL))
        self.assertEqual(LocationValue(pol1).json(self.opt), json.dumps(pol1centre)) 
        self.opt[&#34;json_loc_point&#34;]=False 
        self.assertEqual(LocationValue(pol1).json(self.opt), json.dumps(pol1)) 
        
    def test_DatationValue(self):
        self.opt = ES.mOption.copy()
        self.assertEqual(DatationValue(t1), DatationValue(DatationValue(t1)))
        self.assertEqual(DatationValue(t1).json(self.opt), t1.isoformat()) 
        self.assertEqual(ESValue.maxi(DatationValue(t1), DatationValue(t2)).json(self.opt), t2.isoformat()) 
        self.opt[&#34;json_dat_instant&#34;] = False
        self.assertEqual(DatationValue(json.loads(t1n)).json(self.opt), t1.isoformat()) 
        self.opt[&#34;json_dat_name&#34;] = True
        self.opt[&#34;json_dat_instant&#34;] = True
        self.assertEqual(DatationValue(json.loads(t1n)).json(self.opt), t1n) 
        

    def test_propertyValue(self):
        self.opt = ES.mOption.copy()
        self.assertEqual(PropertyValue().json(self.opt), &#39;{}&#39;) 
        self.opt[&#34;json_prp_type&#34;] = False
        self.assertEqual(PropertyValue({ES.prp_propType : &#34;PM25&#34;}).json(self.opt), &#39;{&#34;&#39;+ES.prp_propType+&#39;&#34;: &#34;PM25&#34;}&#39;)
        self.assertEqual(PropertyValue(pprop_pm10).json(self.opt), json.dumps(pprop_pm10))
        self.opt[&#34;json_prp_type&#34;] = True
        self.assertEqual(PropertyValue(pprop_pm10).json(self.opt), 
                         json.dumps({list(pprop_pm10.keys())[0]: list(pprop_pm10.values())[0]}))
        
    def test_nameValue(self):
        self.assertEqual(DatationValue(&#39;recre&#39;).json(), tnull.isoformat()) 
        self.opt[&#34;json_dat_instant&#34;] = False
        self.opt[&#34;json_dat_name&#34;] = False
        self.assertEqual(DatationValue(&#39;recre&#39;).json(self.opt), tnull.isoformat())
        self.opt[&#34;json_prp_type&#34;] = False
        self.opt[&#34;json_prp_name&#34;] = True
        self.assertEqual(PropertyValue(pprop_pm25).json(self.opt), json.dumps(pprop_pm25))
        self.assertEqual(PropertyValue(&#39;test&#39;).json(self.opt), &#34;test&#34;)
        self.opt[&#34;json_loc_name&#34;] = True
        self.assertEqual(LocationValue(lyon).json(self.opt), json.dumps(lyon))
        self.assertEqual(LocationValue(&#39;test&#39;).json(self.opt), &#34;test&#34;)
        #ob1 = Observation(json.dumps(dict((obs_1, truc_mach, ndat3, loc3, prop2, res_(9)))))
        #option_simple(ob1)
        #ob1.option[&#34;json_loc_name&#34;] = True
        #self.assertEqual([&#39;loc0&#39;, &#39;loc1&#39;, &#39;loc2&#39;], json.loads(ob1.json())[ES.loc_valName[2]])
        
    def test_majValue_majName(self):
        val = LocationValue(lyon)
        val.majValue(LocationValue([4,5]), True)
        self.assertEqual(val.point, [4,5])
        val.majValue(LocationValue([[6,7], [7,8], [8,6]]), False)
        self.assertEqual(val.shap, gshape([[6,7], [7,8], [8,6]]))
        val.majName(&#39;truc&#39;)
        self.assertEqual(val.name, &#39;truc&#39;)     
        val = DatationValue(t1)
        val.majValue(DatationValue(t2), True)
        self.assertEqual(val.instant, t2)
        val.majValue(DatationValue(s1), False)
        self.assertEqual(val.slot, s1)
        val.majName(&#39;truc&#39;)
        self.assertEqual(val.name, &#39;truc&#39;)
    
    def test_ESSet(self):
        self.assertEqual(ESSet(DatationValue, [t1, t2, t3])[1], ESSet(DatationValue, [t1, t2, t3]).maxiBox()) 
        self.assertEqual(ESSet(LocationValue, [paris, lyon, marseille]).maxiBox(), LocationValue(maxi_PLM)) 
        self.assertEqual(ESSet(PropertyValue, [prop_pm10, prop_pm25]).jsonSet(self.opt), json.dumps([prop_pm10, prop_pm25])) 
        self.assertEqual(ESSet(LocationValue, [LocationValue(paris)]).maxiBox(), LocationValue(paris)) 

    def test_ESObs(self):
        da1 = ESSetDatation(Observation(), {ES.dat_valName[0]:[t1, t2, t3]})
        self.assertEqual(da1[1], da1.maxiBox()) 
        da2 = ESSetProperty(Observation(), {ES.prp_valName[0]:[prop_pm10, prop_pm25], ES.prp_upperValue :&#39;254&#39;})
        self.opt[&#34;json_prp_type&#34;] = False
        self.assertEqual(json.loads(&#39;{&#39;+da2.json(self.opt)+&#39;}&#39;)[ES.prp_valName[1]], [prop_pm10, prop_pm25]) 
        self.assertEqual(da2.mAtt[ES.prp_upperValue], &#39;254&#39;) 
        da3 = ESSetResult(Observation(), {ES.res_valName[0]:[r2, r2]})
        self.assertEqual(json.loads(&#39;{&#39;+da3.json(self.opt)+&#39;}&#39;)[ES.res_valName[0]], r2.value)
        da4 = ESSetLocation(Observation(), {ES.loc_valName[0]:[paris, lyon, marseille]})
        self.assertEqual(da4.maxiBox(), LocationValue(maxi_PLM)) 
        da5 = ESSetLocation(Observation(), {ES.loc_classES:{ES.loc_valName[0]:[paris, lyon, marseille], &#39;truc&#39;:&#39;machin&#39;}})
        self.assertEqual(da5.mAtt[&#39;truc&#39;], &#39;machin&#39;) 
        
    def test_ESElement(self):
        el = ESElement()
        el2 = ESElement()
        el2.setAtt(&#39;tric&#39;, &#39;meoc&#39;)
        el.setAtt(&#39;truc&#39;, &#39;mec&#39;)
        el.addComposant(el2)
        self.assertTrue(el.element(&#39;tric&#39;) == None)
        self.assertFalse(el.element(&#39;null&#39;) == None)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>unittest.case.TestCase</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="ES.EStestunitaire.TestObsUnitaire.opt"><code class="name">var <span class="ident">opt</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ES.EStestunitaire.TestObsUnitaire.test_DatationValue"><code class="name flex">
<span>def <span class="ident">test_DatationValue</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_DatationValue(self):
    self.opt = ES.mOption.copy()
    self.assertEqual(DatationValue(t1), DatationValue(DatationValue(t1)))
    self.assertEqual(DatationValue(t1).json(self.opt), t1.isoformat()) 
    self.assertEqual(ESValue.maxi(DatationValue(t1), DatationValue(t2)).json(self.opt), t2.isoformat()) 
    self.opt[&#34;json_dat_instant&#34;] = False
    self.assertEqual(DatationValue(json.loads(t1n)).json(self.opt), t1.isoformat()) 
    self.opt[&#34;json_dat_name&#34;] = True
    self.opt[&#34;json_dat_instant&#34;] = True
    self.assertEqual(DatationValue(json.loads(t1n)).json(self.opt), t1n) </code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObsUnitaire.test_ESElement"><code class="name flex">
<span>def <span class="ident">test_ESElement</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_ESElement(self):
    el = ESElement()
    el2 = ESElement()
    el2.setAtt(&#39;tric&#39;, &#39;meoc&#39;)
    el.setAtt(&#39;truc&#39;, &#39;mec&#39;)
    el.addComposant(el2)
    self.assertTrue(el.element(&#39;tric&#39;) == None)
    self.assertFalse(el.element(&#39;null&#39;) == None)</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObsUnitaire.test_ESObs"><code class="name flex">
<span>def <span class="ident">test_ESObs</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_ESObs(self):
    da1 = ESSetDatation(Observation(), {ES.dat_valName[0]:[t1, t2, t3]})
    self.assertEqual(da1[1], da1.maxiBox()) 
    da2 = ESSetProperty(Observation(), {ES.prp_valName[0]:[prop_pm10, prop_pm25], ES.prp_upperValue :&#39;254&#39;})
    self.opt[&#34;json_prp_type&#34;] = False
    self.assertEqual(json.loads(&#39;{&#39;+da2.json(self.opt)+&#39;}&#39;)[ES.prp_valName[1]], [prop_pm10, prop_pm25]) 
    self.assertEqual(da2.mAtt[ES.prp_upperValue], &#39;254&#39;) 
    da3 = ESSetResult(Observation(), {ES.res_valName[0]:[r2, r2]})
    self.assertEqual(json.loads(&#39;{&#39;+da3.json(self.opt)+&#39;}&#39;)[ES.res_valName[0]], r2.value)
    da4 = ESSetLocation(Observation(), {ES.loc_valName[0]:[paris, lyon, marseille]})
    self.assertEqual(da4.maxiBox(), LocationValue(maxi_PLM)) 
    da5 = ESSetLocation(Observation(), {ES.loc_classES:{ES.loc_valName[0]:[paris, lyon, marseille], &#39;truc&#39;:&#39;machin&#39;}})
    self.assertEqual(da5.mAtt[&#39;truc&#39;], &#39;machin&#39;) </code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObsUnitaire.test_ESSet"><code class="name flex">
<span>def <span class="ident">test_ESSet</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_ESSet(self):
    self.assertEqual(ESSet(DatationValue, [t1, t2, t3])[1], ESSet(DatationValue, [t1, t2, t3]).maxiBox()) 
    self.assertEqual(ESSet(LocationValue, [paris, lyon, marseille]).maxiBox(), LocationValue(maxi_PLM)) 
    self.assertEqual(ESSet(PropertyValue, [prop_pm10, prop_pm25]).jsonSet(self.opt), json.dumps([prop_pm10, prop_pm25])) 
    self.assertEqual(ESSet(LocationValue, [LocationValue(paris)]).maxiBox(), LocationValue(paris)) </code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObsUnitaire.test_ResultValue"><code class="name flex">
<span>def <span class="ident">test_ResultValue</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_ResultValue(self):
    self.opt[&#34;json_res_index&#34;] = True
    self.assertEqual(ResultValue(&#34;coucou&#34;).json(self.opt), &#39;[&#34;coucou&#34;, [-1, -1, -1]]&#39;)
    self.assertEqual(ResultValue([&#34;coucou&#34;, [1, 2, -1]]).json(self.opt), &#39;[&#34;coucou&#34;, [1, 2, -1]]&#39;)
    self.assertEqual(ResultValue(&#34;coucou&#34;, [1, 2, -1]).json(self.opt), &#39;[&#34;coucou&#34;, [1, 2, -1]]&#39;)
    self.assertEqual(ResultValue(&#39;{&#34;er&#34;:2}&#39;, [1, 2, -1]).json(self.opt), &#39;[{&#34;er&#34;: 2}, [1, 2, -1]]&#39;)
    self.assertEqual(ResultValue(&#39;{&#34;er&#34;:2}&#39;).json(self.opt), &#39;[{&#34;er&#34;: 2}, [-1, -1, -1]]&#39;)
    self.assertEqual(ResultValue(&#39;[3,2]&#39;, [1, 2, -1]).json(self.opt), &#39;[&#34;[3, 2]&#34;, [1, 2, -1]]&#39;) 
    self.assertEqual(ResultValue(&#39;[3,2]&#39;).json(self.opt), &#39;[&#34;[3, 2]&#34;, [-1, -1, -1]]&#39;)
    self.assertEqual(ResultValue(21).json(self.opt), &#39;[21, [-1, -1, -1]]&#39;)
    self.assertEqual(ResultValue([23, [1, 2, -1]]).json(self.opt), &#39;[23, [1, 2, -1]]&#39;)
    self.assertEqual(ResultValue(23, [1, 2, -1]).json(self.opt), &#39;[23, [1, 2, -1]]&#39;)
    self.assertEqual(ResultValue(2.1).json(self.opt), &#39;[2.1, [-1, -1, -1]]&#39;)
    self.assertEqual(ResultValue([2.3, [1, 2, -1]]).json(self.opt), &#39;[2.3, [1, 2, -1]]&#39;) 
    self.opt[&#34;json_res_index&#34;] = False
    self.assertEqual(ResultValue(&#34;coucou&#34;).json(self.opt), &#39;&#34;coucou&#34;&#39;)
    self.assertEqual(ResultValue([&#34;coucou&#34;, [1, 2, -1]]).json(self.opt), &#39;&#34;coucou&#34;&#39;)
    self.assertEqual(ResultValue(&#39;{&#34;er&#34;:2}&#39;).json(self.opt), &#39;{&#34;er&#34;: 2}&#39;)
    self.assertEqual(ResultValue(&#39;[{&#34;er&#34;:2}, [1, 2, -1]]&#39;).json(self.opt), &#39;{&#34;er&#34;: 2}&#39;)
    self.assertEqual(ResultValue(22).json(self.opt), &#39;22&#39;)
    self.assertEqual(ResultValue([23, [1, 2, -1]]).json(self.opt), &#39;23&#39;)
    self.assertEqual(ResultValue(2.2).json(self.opt), &#39;2.2&#39;)
    self.assertEqual(ResultValue([2.3, [1, 2, -1]]).json(self.opt), &#39;2.3&#39;)
    self.opt[&#34;json_res_index&#34;] = True</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObsUnitaire.test_locationValue"><code class="name flex">
<span>def <span class="ident">test_locationValue</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_locationValue(self):
    self.opt = ES.mOption.copy()
    self.assertEqual(LocationValue(lyon).json(self.opt), json.dumps(lyon)) 
    self.assertEqual(LocationValue(lyon), LocationValue(LocationValue(lyon)))
    self.assertEqual(ESValue.mini(LocationValue(lyon), LocationValue(paris)).json(self.opt), json.dumps(mini_PL))
    self.assertEqual(LocationValue(pol1).json(self.opt), json.dumps(pol1centre)) 
    self.opt[&#34;json_loc_point&#34;]=False 
    self.assertEqual(LocationValue(pol1).json(self.opt), json.dumps(pol1)) </code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObsUnitaire.test_majValue_majName"><code class="name flex">
<span>def <span class="ident">test_majValue_majName</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_majValue_majName(self):
    val = LocationValue(lyon)
    val.majValue(LocationValue([4,5]), True)
    self.assertEqual(val.point, [4,5])
    val.majValue(LocationValue([[6,7], [7,8], [8,6]]), False)
    self.assertEqual(val.shap, gshape([[6,7], [7,8], [8,6]]))
    val.majName(&#39;truc&#39;)
    self.assertEqual(val.name, &#39;truc&#39;)     
    val = DatationValue(t1)
    val.majValue(DatationValue(t2), True)
    self.assertEqual(val.instant, t2)
    val.majValue(DatationValue(s1), False)
    self.assertEqual(val.slot, s1)
    val.majName(&#39;truc&#39;)
    self.assertEqual(val.name, &#39;truc&#39;)</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObsUnitaire.test_nameValue"><code class="name flex">
<span>def <span class="ident">test_nameValue</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_nameValue(self):
    self.assertEqual(DatationValue(&#39;recre&#39;).json(), tnull.isoformat()) 
    self.opt[&#34;json_dat_instant&#34;] = False
    self.opt[&#34;json_dat_name&#34;] = False
    self.assertEqual(DatationValue(&#39;recre&#39;).json(self.opt), tnull.isoformat())
    self.opt[&#34;json_prp_type&#34;] = False
    self.opt[&#34;json_prp_name&#34;] = True
    self.assertEqual(PropertyValue(pprop_pm25).json(self.opt), json.dumps(pprop_pm25))
    self.assertEqual(PropertyValue(&#39;test&#39;).json(self.opt), &#34;test&#34;)
    self.opt[&#34;json_loc_name&#34;] = True
    self.assertEqual(LocationValue(lyon).json(self.opt), json.dumps(lyon))
    self.assertEqual(LocationValue(&#39;test&#39;).json(self.opt), &#34;test&#34;)
    #ob1 = Observation(json.dumps(dict((obs_1, truc_mach, ndat3, loc3, prop2, res_(9)))))
    #option_simple(ob1)
    #ob1.option[&#34;json_loc_name&#34;] = True
    #self.assertEqual([&#39;loc0&#39;, &#39;loc1&#39;, &#39;loc2&#39;], json.loads(ob1.json())[ES.loc_valName[2]])</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObsUnitaire.test_propertyValue"><code class="name flex">
<span>def <span class="ident">test_propertyValue</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_propertyValue(self):
    self.opt = ES.mOption.copy()
    self.assertEqual(PropertyValue().json(self.opt), &#39;{}&#39;) 
    self.opt[&#34;json_prp_type&#34;] = False
    self.assertEqual(PropertyValue({ES.prp_propType : &#34;PM25&#34;}).json(self.opt), &#39;{&#34;&#39;+ES.prp_propType+&#39;&#34;: &#34;PM25&#34;}&#39;)
    self.assertEqual(PropertyValue(pprop_pm10).json(self.opt), json.dumps(pprop_pm10))
    self.opt[&#34;json_prp_type&#34;] = True
    self.assertEqual(PropertyValue(pprop_pm10).json(self.opt), 
                     json.dumps({list(pprop_pm10.keys())[0]: list(pprop_pm10.values())[0]}))</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="ES.EStestunitaire.TestObservation"><code class="flex name class">
<span>class <span class="ident">TestObservation</span></span>
<span>(</span><span>methodName='runTest')</span>
</code></dt>
<dd>
<div class="desc"><p>A class whose instances are single test cases.</p>
<p>By default, the test code itself should be placed in a method named
'runTest'.</p>
<p>If the fixture may be used for many test cases, create as
many test methods as are needed. When instantiating such a TestCase
subclass, specify in the constructor arguments the name of the test method
that the instance is to execute.</p>
<p>Test authors should subclass TestCase for their own tests. Construction
and deconstruction of the test's environment ('fixture') can be
implemented by overriding the 'setUp' and 'tearDown' methods respectively.</p>
<p>If it is necessary to override the <strong>init</strong> method, the base class
<strong>init</strong> method must always be called. It is important that subclasses
should not change the signature of their <strong>init</strong> method, since instances
of the classes are instantiated automatically by parts of the framework
in order to be run.</p>
<p>When subclassing TestCase, you can set these attributes:
* failureException: determines which exception will be raised when
the instance's assertion methods fail; test methods raising this
exception will be deemed to have 'failed' rather than 'errored'.
* longMessage: determines whether long messages (including repr of
objects used in assert methods) will be printed on failure in <em>addition</em>
to any explicit message passed.
* maxDiff: sets the maximum length of a diff in failure messages
by assert methods using difflib. It is looked up as an instance
attribute so can be configured by individual tests if required.</p>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@unittest.skipIf(simple, &#34;test observation&#34;)
class TestObservation(unittest.TestCase):

    def test_obs_vList(self):
        ob1 = Observation(dict((obs_1, truc_mach, dat3, loc3)))
        self.assertEqual(ob1.setDatation.vListName[0], &#39;date1&#39;)
        self.assertEqual(ob1.setDatation.vListName[1], &#39;dat1&#39;)
        self.assertEqual(ob1.setLocation.vListPoint, [paris, lyon, marseille])
        self.assertEqual(ob1.setDatation.vListInstant, [t1, t2, t3])
        ob1 = Observation(dict((obs_1, truc_mach, dat3, dpt2)))
        self.assertEqual(ob1.setLocation.vListPoint[0], pol1centre)

    def test_obs_simple(self):
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3))))
        option_simple(ob1)
        self.assertEqual(dict((obs_1, truc_mach, dat3sn)),    json.loads(ob1.json()))
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, loc3))))
        option_simple(ob1)
        self.assertEqual(dict((obs_1, truc_mach, loc3sn)),    json.loads(ob1.json()))
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, prop2))))
        option_simple(ob1)
        ob1.option[&#34;json_prp_type&#34;] = False
        self.assertEqual(dict((obs_1, truc_mach, prop2)),    json.loads(ob1.json()))
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, res_(9)))))
        option_simple(ob1)
        self.assertEqual(dict((obs_1, truc_mach, res_(9))),    json.loads(ob1.json()))
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(9)))))
        option_simple(ob1)
        self.assertEqual(dict((obs_1, truc_mach, dat3sn, loc3sn, prop2, res_(9))),json.loads(ob1.json()))
        
    def test_obs_att(self):
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, 
                                           (ES.obs_reference, 25), (ES.prp_upperValue,&#39;254&#39;),
                                           res_(9)))))
        self.assertEqual(ob1.mAtt[&#39;truc&#39;], &#39;machin&#39;)
        self.assertEqual(ob1.mAtt[ES.obs_reference], 25)
        self.assertEqual(ob1.setProperty.mAtt[ES.prp_upperValue], &#39;254&#39;)

    def test_obs_options(self):
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(9)))))
        option_simple(ob1)
        ob1.option[&#34;json_res_index&#34;] = True
        self.assertEqual(json.loads(ob1.json())[ES.res_valName[0]][0], [val_(9)[0], ES.nullInd])
        ob1.option[&#34;json_ESobs_class&#34;] = True
        self.assertTrue(ES.dat_classES in json.loads(ob1.json()))
        self.assertTrue(ES.res_classES in json.loads(ob1.json()))
        self.assertTrue(ES.loc_classES in json.loads(ob1.json()))
        self.assertTrue(ES.prp_classES in json.loads(ob1.json()))
        ob1.option[&#34;json_elt_type&#34;] = True
        self.assertTrue(ES.type + ES.dat_classES in json.loads(ob1.json())[ES.dat_classES])
        self.assertTrue(ES.type + ES.res_classES in json.loads(ob1.json())[ES.res_classES])
        self.assertTrue(ES.type + ES.loc_classES in json.loads(ob1.json())[ES.loc_classES])
        self.assertTrue(ES.type + ES.prp_classES in json.loads(ob1.json())[ES.prp_classES])
        ob1.option[&#34;json_obs_val&#34;] = False
        self.assertTrue(ES.dat_classES in json.loads(&#39;{&#39; + ob1.json() + &#39;}&#39;))
        ob1.option[&#34;json_obs_val&#34;] = True
        ob1.option[&#34;json_obs_attrib&#34;] = True
        self.assertTrue(ES.obs_attributes in json.loads(ob1.json()))
        ob1.option[&#34;json_info_type&#34;] = True
        ob1.option[&#34;json_info_nval&#34;] = True
        ob1.option[&#34;json_info_autre&#34;] = True
        ob1.option[&#34;json_info_box&#34;] = True
        ob2 = Observation(ob1.json())
        self.assertTrue(ES.type in json.loads(ob2.json()))
        
    def test_obs_maj_type(self):
        maj = [False, True]
        for maj_index in maj:
            ob = Observation()
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 0 and not ob.complet )
            ob = Observation(json.dumps(dict((obs_1, dat1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 1 and not ob.complet )
            ob = Observation(json.dumps(dict((obs_1, dat3))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 2 and not ob.complet )
            ob = Observation(json.dumps(dict((obs_1, loc1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 10 and not ob.complet)
            ob = Observation(json.dumps(dict((obs_1, loc1, dat1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 11 and not ob.complet)
            ob = Observation(json.dumps(dict((obs_1, loc1, dat3))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 12 and not ob.complet)
            ob = Observation(json.dumps(dict((obs_1, loc3))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 20 and not ob.complet)
            ob = Observation(json.dumps(dict((obs_1, loc3, dat1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 21 and not ob.complet)
            ob = Observation(json.dumps(dict((obs_1, loc3, dat3))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 22 and not ob.complet)
            ob = Observation(json.dumps(dict((obs_1, res_(1)))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 0 and ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), dat1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 1 and ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), dat3))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 2 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), loc1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 10 and ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), loc1, dat1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 11 and ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), loc1, dat3))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 12 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), loc3))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 20 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), loc3, dat1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 21 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), loc3, dat3))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 22 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(1), loc3, dat2))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 22 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(9)))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 0 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(9), dat1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 1 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(3), dat3, prop1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 102 and ob.complet and ob.setResult.axes == [0])
            ob = Observation(json.dumps(dict((obs_1, res_(6), dat3, prop1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 102 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(3), loc1, prop1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 110 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(3), loc1, dat1, prop1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 111 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(3), loc1, dat3, prop1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 112 and ob.complet and ob.setResult.axes == [0])
            ob = Observation(json.dumps(dict((obs_1, res_(6), loc1, dat3, prop1))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 112 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(6), loc3, prop2))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 220 and ob.complet and ob.setResult.axes == [1, 2])
            ob = Observation(json.dumps(dict((obs_1, res_(9), loc3, prop2))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 220 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(9), loc3, dat1, prop2))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 221 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, res_(6), loc3, dat1, prop2))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 224 and ob.complet and ob.setResult.axes == [1, 2])
            ob = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18)))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 228 and ob.complet and ob.setResult.axes == [0, 1, 2])
            ob = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(9)))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 222 and not ob.complet and ob.setResult.axes == [])
            ob = Observation(json.dumps(dict((obs_1, dat3, loc3, prop2, res_(6)))))
            majType_avec_option(ob, maj_index)
            self.assertTrue(ob.score == 225 and ob.complet and ob.setResult.axes == [10, 2])
            #envoi_mongo(ob)
            #ob.option[&#34;json_res_index&#34;] = True
            #print(ob.json(), &#39;\n&#39;)

    def test_obs_dim(self):
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat2, loc3, prop3, res_(6)))),&#39;xd&#39;)
        self.assertTrue(ob1.score == 227 and ob1.complet and ob1.setResult.axes == [0, 21])
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc2, prop3, res_(6)))),&#39;lx&#39;)
        self.assertTrue(ob1.score == 226 and ob1.complet and ob1.setResult.axes == [20, 1])
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop3, res_(3)))),&#39;x&#39;)
        self.assertTrue(ob1.score == 222 and ob1.complet and ob1.setResult.axes == [120])

    def test_obs_majListName_majListValue(self):
        ob1 = Observation(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18))))
        ob1.majList(LocationValue, [pparis, plyon, pmarseille], &#39;base&#39;)
        self.assertEqual(ob1.setLocation.valueList[2].point, pmarseille)
        ob1.majList(DatationValue, [pt1, pt2, pt3], &#39;base&#39;)
        self.assertEqual(ob1.setDatation.valueList[2].instant, pt3)
        ob1.majList(LocationValue, [&#39;paris&#39;, &#39;lyon&#39;, &#39;marseille&#39;], &#39;name&#39;)
        self.assertEqual(ob1.setLocation.valueList[2].name, &#39;marseille&#39;)

    def test_obs_majIndex_iloc(self):
        ob1 = Observation(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18))))
        self.assertEqual(ob1.iloc(0,0,1)[ES.res_classES], &#39;1&#39;)
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18)))),&#39;lpd&#39;)
        self.assertEqual(ob1.iloc(0,0,1)[ES.res_classES], &#39;3&#39;)
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18)))),&#39;pdl&#39;)
        self.assertEqual(ob1.iloc(0,0,1)[ES.res_classES], &#39;9&#39;)
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(6)))),&#39;xp&#39;)
        self.assertEqual(ob1.iloc(0,0,1)[ES.res_classES], &#39;1&#39;)
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(6)))),&#39;px&#39;)
        self.assertEqual(ob1.iloc(0,0,1)[ES.res_classES], &#39;3&#39;)
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat2, loc3, prop3, res_(6)))),&#39;xd&#39;)
        self.assertEqual(ob1.iloc(0,1,1)[ES.res_classES], &#39;2&#39;)
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc2, prop3, res_(6)))),&#39;lx&#39;)
        self.assertEqual(ob1.iloc(0,1,0)[ES.res_classES], &#39;3&#39;)
        ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop3, res_(3)))),&#39;x&#39;)
        self.assertEqual(ob1.iloc(1,1,1)[ES.res_classES], &#39;1&#39;)

    def test_obs_sort(self):
        ob = Observation(dict((obs_1, dat3, dpt3, prop2, res_(6))), &#39;px&#39;)
        test = ob.iloc(1,1,0)
        ob.sort(cross = False)
        self.assertEqual(ob.iloc(2,1,1), test)
        ob.sort()
        self.assertEqual(ob.iloc(2,2,1), test)
        ob.sort(cross = False, order = [1,0,2])
        self.assertEqual(ob.iloc(2,1,1), test)
        ob.sort(order = [1,0,2])
        self.assertEqual(ob.iloc(1,1,1), test)
        
    def test_obs_creation(self):
        obs1 = Observation()
        self.assertEqual(obs1.classES,                   ES.obs_classES)
        self.assertEqual(ESSetDatation(obs1).classES,    ES.dat_classES)
        self.assertEqual(ESSetResult(obs1).classES,      ES.res_classES)
        self.assertEqual(ESSetProperty(obs1).classES,    ES.prp_classES)
        self.assertEqual(ESSetLocation(obs1).classES,    ES.loc_classES)
      
        ob = Observation(json.dumps(dict([obs_1, res_(9)])))
        self.assertEqual(json.loads(ob.json())[ES.res_valName[0]], val_(9))

    def test_obs_add(self):
        ob = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18)))))
        ob.option[&#34;json_prp_type&#34;] = False
        ob.option[&#34;json_loc_name&#34;] = ob.option[&#34;json_dat_name&#34;] = ob.option[&#34;json_prp_name&#34;] = True
        obp = Observation(json.dumps(dict((obs_1, truc_mach, pdat3, ploc3, pprop2, res_(18)))))
        obp.option[&#34;json_prp_type&#34;] = False
        obp.option[&#34;json_loc_name&#34;] = obp.option[&#34;json_dat_name&#34;] = obp.option[&#34;json_prp_name&#34;] = True
        obc = copy(ob)
        obc.option[&#34;json_prp_type&#34;] = False
        obc.option[&#34;json_loc_name&#34;] = obc.option[&#34;json_dat_name&#34;] = obc.option[&#34;json_prp_name&#34;] = True
        obc += ob
        self.assertEqual(json.loads(ob.json())[ES.res_valName[0]], json.loads(obc.json())[ES.res_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.dat_valName[0]], json.loads(obc.json())[ES.dat_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]], json.loads(obc.json())[ES.loc_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.prp_valName[1]], json.loads(obc.json())[ES.prp_valName[1]])
        ob2 = ob + ob
        self.assertEqual(json.loads(ob.json())[ES.res_valName[0]], json.loads(ob2.json())[ES.res_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.dat_valName[0]], json.loads(ob2.json())[ES.dat_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]], json.loads(ob2.json())[ES.loc_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.prp_valName[1]], json.loads(ob2.json())[ES.prp_valName[1]])
        obc = copy(ob)
        obc += obp
        self.assertEqual(json.loads(ob.json())[ES.res_valName[0]] + json.loads(obp.json())[ES.res_valName[0]], 
                         json.loads(obc.json())[ES.res_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.dat_valName[0]] + json.loads(obp.json())[ES.dat_valName[0]],
                         json.loads(obc.json())[ES.dat_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]] + json.loads(obp.json())[ES.loc_valName[0]],
                         json.loads(obc.json())[ES.loc_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.prp_valName[1]] + json.loads(obp.json())[ES.prp_valName[1]],
                         json.loads(obc.json())[ES.prp_valName[1]])
        ob2 = ob + obp
        self.assertEqual(json.loads(ob.json())[ES.res_valName[0]] + json.loads(obp.json())[ES.res_valName[0]], 
                         json.loads(ob2.json())[ES.res_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.dat_valName[0]] + json.loads(obp.json())[ES.dat_valName[0]],
                         json.loads(ob2.json())[ES.dat_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]] + json.loads(obp.json())[ES.loc_valName[0]],
                         json.loads(ob2.json())[ES.loc_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.prp_valName[1]] + json.loads(obp.json())[ES.prp_valName[1]],
                         json.loads(ob2.json())[ES.prp_valName[1]])
        obp2 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, pprop2, res_(18)))))
        obp2.option[&#34;json_prp_type&#34;] = False
        ob2 = ob + obp2
        self.assertEqual(json.loads(ob.json())[ES.res_valName[0]] + json.loads(obp.json())[ES.res_valName[0]], 
                         json.loads(ob2.json())[ES.res_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.dat_valName[0]], json.loads(ob2.json())[ES.dat_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]], json.loads(ob2.json())[ES.loc_valName[0]])
        self.assertEqual(json.loads(ob.json())[ES.prp_valName[1]] + json.loads(obp2.json())[ES.prp_valName[1]],
                         json.loads(ob2.json())[ES.prp_valName[1]])

    def test_obs_extend(self):
        ob = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2))))
        obp = Observation(json.dumps(dict((obs_1, res_(18)))))
        ob.extend(obp)
        self.assertEqual(json.loads(ob.json())[ES.res_valName[0]], json.loads(obp.json())[ES.res_valName[0]])
        ob = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2))))
        obp = Observation(json.dumps(dict((obs_1, ploc3, res_(18)))))
        obc = copy(ob)
        ob.extend(obp)
        self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]], json.loads(obc.json())[ES.loc_valName[0]])

    def test_sensor(self):
        obs = Observation()
        nprop1 = obs.addValue(PropertyValue(prop_pm25))
        for i in range(6): # simule une boucle de mesure
            nres = obs.addValueSensor(ResultValue(45+i), 
                                DatationValue(datetime(2021, 6, 4+i, 12, 5).isoformat()),
                                LocationValue([14+i, 40]),
                                nprop1)
        obs.majType()
        obs.option[&#34;json_ESobs_class&#34;] = True
        obs.option[&#34;json_elt_type&#34;] = True
        self.assertEqual(json.loads(obs.json())[ES.information][&#34;typeobs&#34;], ES.obsCat[122])
        
    def test_geo_interface(self):
        ob = Observation(json.dumps(dict([obs_1, loc3])))
        res_loc = (tuple(paris), tuple(lyon), tuple(marseille))
        res_geo = dict([(ES.type,&#34;MultiPoint&#34;), (&#34;coordinates&#34;,res_loc)])
        self.assertEqual(ob.__geo_interface__, res_geo)
        self.assertEqual(ob.__geo_interface__[&#34;coordinates&#34;], res_loc)
        ob.option[&#34;json_loc_point&#34;] = False
        self.assertEqual(ob.__geo_interface__, res_geo)
        ob = Observation(json.dumps(dict((obs_1, dpt2, dat1))))
        dpt2pt = {&#39;type&#39;: &#39;MultiPoint&#39;, &#39;coordinates&#39;: ((0.666667, 1.333333), (1.0, 1.666667))}
        self.assertEqual(ob.__geo_interface__, dpt2pt)
        ob.option[&#34;json_loc_point&#34;] = False
        dpt2pol = {&#39;type&#39;: &#39;MultiPolygon&#39;, &#39;coordinates&#39;: [(((0.0, 1.0), (1.0, 2.0), (1.0, 1.0), (0.0, 1.0)),),
                                                           (((0.0, 2.0), (2.0, 2.0), (1.0, 1.0), (0.0, 2.0)),)]}
        self.assertEqual(ob.__geo_interface__, dpt2pol)

    def test_obs_polygon(self):
        ob = Observation(json.dumps(dict((obs_1, dat3, dpt2, prop2, res_(6)))))
        ob.option[&#34;json_loc_point&#34;] = False
        self.assertEqual(json.dumps(ob.__geo_interface__), 
                         json.dumps({&#34;type&#34;: &#34;MultiPolygon&#34;, &#34;coordinates&#34;: dpt2[1]}))
        
    def test_xarray(self):
        ob = Observation(dict((obs_1, dat3, loc3, prop2, res_(6))), &#39;xp&#39;)
        self.assertTrue(ob.to_xarray()[2,1].item() == ResultValue(2))
        ob = Observation(dict((obs_1, dat3, loc3, prop1, res_(3))), &#39;xp&#39;)
        self.assertTrue(ob.to_xarray()[1].item() == ResultValue(2))
        ob = Observation(dict((obs_1, dat3, loc3, prop3, res_(3))), &#39;dlp&#39;)
        self.assertTrue(ob.to_xarray()[1].item() == ResultValue(2))
        ob = Observation(dict((obs_1, dat3, loc3, prop2, res_(18))), &#39;dlp&#39;)
        self.assertTrue(ob.to_xarray()[2,1,0].item() == ResultValue(9))
        ob = Observation(dict((obs_1, dat3, loc2, prop1, res_(6))), &#39;dlp&#39;)
        self.assertTrue(ob.to_xarray()[2,0].item() == ResultValue(2))
        
    def test_exports(self):
        ob = Observation(json.dumps(dict((obs_1, dat3, dpt3, prop1, res_(3)))), &#39;px&#39;)
        #ob.majType()
        #self.assertTrue(type(ob.to_xarray()) != type(None))
        #self.assertTrue(type(ob.to_dataFrame()) != type(None))
        #self.assertTrue(ob.choropleth() != None)
        #self.assertTrue(type(ob.to_geoDataFrame()) != type(None))
        self.assertTrue(ob.jsonFeature != &#39;&#39;)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>unittest.case.TestCase</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="ES.EStestunitaire.TestObservation.test_exports"><code class="name flex">
<span>def <span class="ident">test_exports</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_exports(self):
    ob = Observation(json.dumps(dict((obs_1, dat3, dpt3, prop1, res_(3)))), &#39;px&#39;)
    #ob.majType()
    #self.assertTrue(type(ob.to_xarray()) != type(None))
    #self.assertTrue(type(ob.to_dataFrame()) != type(None))
    #self.assertTrue(ob.choropleth() != None)
    #self.assertTrue(type(ob.to_geoDataFrame()) != type(None))
    self.assertTrue(ob.jsonFeature != &#39;&#39;)</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObservation.test_geo_interface"><code class="name flex">
<span>def <span class="ident">test_geo_interface</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_geo_interface(self):
    ob = Observation(json.dumps(dict([obs_1, loc3])))
    res_loc = (tuple(paris), tuple(lyon), tuple(marseille))
    res_geo = dict([(ES.type,&#34;MultiPoint&#34;), (&#34;coordinates&#34;,res_loc)])
    self.assertEqual(ob.__geo_interface__, res_geo)
    self.assertEqual(ob.__geo_interface__[&#34;coordinates&#34;], res_loc)
    ob.option[&#34;json_loc_point&#34;] = False
    self.assertEqual(ob.__geo_interface__, res_geo)
    ob = Observation(json.dumps(dict((obs_1, dpt2, dat1))))
    dpt2pt = {&#39;type&#39;: &#39;MultiPoint&#39;, &#39;coordinates&#39;: ((0.666667, 1.333333), (1.0, 1.666667))}
    self.assertEqual(ob.__geo_interface__, dpt2pt)
    ob.option[&#34;json_loc_point&#34;] = False
    dpt2pol = {&#39;type&#39;: &#39;MultiPolygon&#39;, &#39;coordinates&#39;: [(((0.0, 1.0), (1.0, 2.0), (1.0, 1.0), (0.0, 1.0)),),
                                                       (((0.0, 2.0), (2.0, 2.0), (1.0, 1.0), (0.0, 2.0)),)]}
    self.assertEqual(ob.__geo_interface__, dpt2pol)</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObservation.test_obs_add"><code class="name flex">
<span>def <span class="ident">test_obs_add</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_obs_add(self):
    ob = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18)))))
    ob.option[&#34;json_prp_type&#34;] = False
    ob.option[&#34;json_loc_name&#34;] = ob.option[&#34;json_dat_name&#34;] = ob.option[&#34;json_prp_name&#34;] = True
    obp = Observation(json.dumps(dict((obs_1, truc_mach, pdat3, ploc3, pprop2, res_(18)))))
    obp.option[&#34;json_prp_type&#34;] = False
    obp.option[&#34;json_loc_name&#34;] = obp.option[&#34;json_dat_name&#34;] = obp.option[&#34;json_prp_name&#34;] = True
    obc = copy(ob)
    obc.option[&#34;json_prp_type&#34;] = False
    obc.option[&#34;json_loc_name&#34;] = obc.option[&#34;json_dat_name&#34;] = obc.option[&#34;json_prp_name&#34;] = True
    obc += ob
    self.assertEqual(json.loads(ob.json())[ES.res_valName[0]], json.loads(obc.json())[ES.res_valName[0]])
    self.assertEqual(json.loads(ob.json())[ES.dat_valName[0]], json.loads(obc.json())[ES.dat_valName[0]])
    self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]], json.loads(obc.json())[ES.loc_valName[0]])
    self.assertEqual(json.loads(ob.json())[ES.prp_valName[1]], json.loads(obc.json())[ES.prp_valName[1]])
    ob2 = ob + ob
    self.assertEqual(json.loads(ob.json())[ES.res_valName[0]], json.loads(ob2.json())[ES.res_valName[0]])
    self.assertEqual(json.loads(ob.json())[ES.dat_valName[0]], json.loads(ob2.json())[ES.dat_valName[0]])
    self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]], json.loads(ob2.json())[ES.loc_valName[0]])
    self.assertEqual(json.loads(ob.json())[ES.prp_valName[1]], json.loads(ob2.json())[ES.prp_valName[1]])
    obc = copy(ob)
    obc += obp
    self.assertEqual(json.loads(ob.json())[ES.res_valName[0]] + json.loads(obp.json())[ES.res_valName[0]], 
                     json.loads(obc.json())[ES.res_valName[0]])
    self.assertEqual(json.loads(ob.json())[ES.dat_valName[0]] + json.loads(obp.json())[ES.dat_valName[0]],
                     json.loads(obc.json())[ES.dat_valName[0]])
    self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]] + json.loads(obp.json())[ES.loc_valName[0]],
                     json.loads(obc.json())[ES.loc_valName[0]])
    self.assertEqual(json.loads(ob.json())[ES.prp_valName[1]] + json.loads(obp.json())[ES.prp_valName[1]],
                     json.loads(obc.json())[ES.prp_valName[1]])
    ob2 = ob + obp
    self.assertEqual(json.loads(ob.json())[ES.res_valName[0]] + json.loads(obp.json())[ES.res_valName[0]], 
                     json.loads(ob2.json())[ES.res_valName[0]])
    self.assertEqual(json.loads(ob.json())[ES.dat_valName[0]] + json.loads(obp.json())[ES.dat_valName[0]],
                     json.loads(ob2.json())[ES.dat_valName[0]])
    self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]] + json.loads(obp.json())[ES.loc_valName[0]],
                     json.loads(ob2.json())[ES.loc_valName[0]])
    self.assertEqual(json.loads(ob.json())[ES.prp_valName[1]] + json.loads(obp.json())[ES.prp_valName[1]],
                     json.loads(ob2.json())[ES.prp_valName[1]])
    obp2 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, pprop2, res_(18)))))
    obp2.option[&#34;json_prp_type&#34;] = False
    ob2 = ob + obp2
    self.assertEqual(json.loads(ob.json())[ES.res_valName[0]] + json.loads(obp.json())[ES.res_valName[0]], 
                     json.loads(ob2.json())[ES.res_valName[0]])
    self.assertEqual(json.loads(ob.json())[ES.dat_valName[0]], json.loads(ob2.json())[ES.dat_valName[0]])
    self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]], json.loads(ob2.json())[ES.loc_valName[0]])
    self.assertEqual(json.loads(ob.json())[ES.prp_valName[1]] + json.loads(obp2.json())[ES.prp_valName[1]],
                     json.loads(ob2.json())[ES.prp_valName[1]])</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObservation.test_obs_att"><code class="name flex">
<span>def <span class="ident">test_obs_att</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_obs_att(self):
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, 
                                       (ES.obs_reference, 25), (ES.prp_upperValue,&#39;254&#39;),
                                       res_(9)))))
    self.assertEqual(ob1.mAtt[&#39;truc&#39;], &#39;machin&#39;)
    self.assertEqual(ob1.mAtt[ES.obs_reference], 25)
    self.assertEqual(ob1.setProperty.mAtt[ES.prp_upperValue], &#39;254&#39;)</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObservation.test_obs_creation"><code class="name flex">
<span>def <span class="ident">test_obs_creation</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_obs_creation(self):
    obs1 = Observation()
    self.assertEqual(obs1.classES,                   ES.obs_classES)
    self.assertEqual(ESSetDatation(obs1).classES,    ES.dat_classES)
    self.assertEqual(ESSetResult(obs1).classES,      ES.res_classES)
    self.assertEqual(ESSetProperty(obs1).classES,    ES.prp_classES)
    self.assertEqual(ESSetLocation(obs1).classES,    ES.loc_classES)
  
    ob = Observation(json.dumps(dict([obs_1, res_(9)])))
    self.assertEqual(json.loads(ob.json())[ES.res_valName[0]], val_(9))</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObservation.test_obs_dim"><code class="name flex">
<span>def <span class="ident">test_obs_dim</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_obs_dim(self):
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat2, loc3, prop3, res_(6)))),&#39;xd&#39;)
    self.assertTrue(ob1.score == 227 and ob1.complet and ob1.setResult.axes == [0, 21])
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc2, prop3, res_(6)))),&#39;lx&#39;)
    self.assertTrue(ob1.score == 226 and ob1.complet and ob1.setResult.axes == [20, 1])
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop3, res_(3)))),&#39;x&#39;)
    self.assertTrue(ob1.score == 222 and ob1.complet and ob1.setResult.axes == [120])</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObservation.test_obs_extend"><code class="name flex">
<span>def <span class="ident">test_obs_extend</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_obs_extend(self):
    ob = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2))))
    obp = Observation(json.dumps(dict((obs_1, res_(18)))))
    ob.extend(obp)
    self.assertEqual(json.loads(ob.json())[ES.res_valName[0]], json.loads(obp.json())[ES.res_valName[0]])
    ob = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2))))
    obp = Observation(json.dumps(dict((obs_1, ploc3, res_(18)))))
    obc = copy(ob)
    ob.extend(obp)
    self.assertEqual(json.loads(ob.json())[ES.loc_valName[0]], json.loads(obc.json())[ES.loc_valName[0]])</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObservation.test_obs_majIndex_iloc"><code class="name flex">
<span>def <span class="ident">test_obs_majIndex_iloc</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_obs_majIndex_iloc(self):
    ob1 = Observation(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18))))
    self.assertEqual(ob1.iloc(0,0,1)[ES.res_classES], &#39;1&#39;)
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18)))),&#39;lpd&#39;)
    self.assertEqual(ob1.iloc(0,0,1)[ES.res_classES], &#39;3&#39;)
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18)))),&#39;pdl&#39;)
    self.assertEqual(ob1.iloc(0,0,1)[ES.res_classES], &#39;9&#39;)
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(6)))),&#39;xp&#39;)
    self.assertEqual(ob1.iloc(0,0,1)[ES.res_classES], &#39;1&#39;)
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(6)))),&#39;px&#39;)
    self.assertEqual(ob1.iloc(0,0,1)[ES.res_classES], &#39;3&#39;)
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat2, loc3, prop3, res_(6)))),&#39;xd&#39;)
    self.assertEqual(ob1.iloc(0,1,1)[ES.res_classES], &#39;2&#39;)
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc2, prop3, res_(6)))),&#39;lx&#39;)
    self.assertEqual(ob1.iloc(0,1,0)[ES.res_classES], &#39;3&#39;)
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop3, res_(3)))),&#39;x&#39;)
    self.assertEqual(ob1.iloc(1,1,1)[ES.res_classES], &#39;1&#39;)</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObservation.test_obs_majListName_majListValue"><code class="name flex">
<span>def <span class="ident">test_obs_majListName_majListValue</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_obs_majListName_majListValue(self):
    ob1 = Observation(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18))))
    ob1.majList(LocationValue, [pparis, plyon, pmarseille], &#39;base&#39;)
    self.assertEqual(ob1.setLocation.valueList[2].point, pmarseille)
    ob1.majList(DatationValue, [pt1, pt2, pt3], &#39;base&#39;)
    self.assertEqual(ob1.setDatation.valueList[2].instant, pt3)
    ob1.majList(LocationValue, [&#39;paris&#39;, &#39;lyon&#39;, &#39;marseille&#39;], &#39;name&#39;)
    self.assertEqual(ob1.setLocation.valueList[2].name, &#39;marseille&#39;)</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObservation.test_obs_maj_type"><code class="name flex">
<span>def <span class="ident">test_obs_maj_type</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_obs_maj_type(self):
    maj = [False, True]
    for maj_index in maj:
        ob = Observation()
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 0 and not ob.complet )
        ob = Observation(json.dumps(dict((obs_1, dat1))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 1 and not ob.complet )
        ob = Observation(json.dumps(dict((obs_1, dat3))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 2 and not ob.complet )
        ob = Observation(json.dumps(dict((obs_1, loc1))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 10 and not ob.complet)
        ob = Observation(json.dumps(dict((obs_1, loc1, dat1))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 11 and not ob.complet)
        ob = Observation(json.dumps(dict((obs_1, loc1, dat3))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 12 and not ob.complet)
        ob = Observation(json.dumps(dict((obs_1, loc3))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 20 and not ob.complet)
        ob = Observation(json.dumps(dict((obs_1, loc3, dat1))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 21 and not ob.complet)
        ob = Observation(json.dumps(dict((obs_1, loc3, dat3))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 22 and not ob.complet)
        ob = Observation(json.dumps(dict((obs_1, res_(1)))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 0 and ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(1), dat1))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 1 and ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(1), dat3))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 2 and not ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(1), loc1))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 10 and ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(1), loc1, dat1))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 11 and ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(1), loc1, dat3))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 12 and not ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(1), loc3))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 20 and not ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(1), loc3, dat1))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 21 and not ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(1), loc3, dat3))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 22 and not ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(1), loc3, dat2))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 22 and not ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(9)))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 0 and not ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(9), dat1))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 1 and not ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(3), dat3, prop1))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 102 and ob.complet and ob.setResult.axes == [0])
        ob = Observation(json.dumps(dict((obs_1, res_(6), dat3, prop1))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 102 and not ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(3), loc1, prop1))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 110 and not ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(3), loc1, dat1, prop1))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 111 and not ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(3), loc1, dat3, prop1))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 112 and ob.complet and ob.setResult.axes == [0])
        ob = Observation(json.dumps(dict((obs_1, res_(6), loc1, dat3, prop1))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 112 and not ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(6), loc3, prop2))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 220 and ob.complet and ob.setResult.axes == [1, 2])
        ob = Observation(json.dumps(dict((obs_1, res_(9), loc3, prop2))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 220 and not ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(9), loc3, dat1, prop2))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 221 and not ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, res_(6), loc3, dat1, prop2))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 224 and ob.complet and ob.setResult.axes == [1, 2])
        ob = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(18)))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 228 and ob.complet and ob.setResult.axes == [0, 1, 2])
        ob = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(9)))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 222 and not ob.complet and ob.setResult.axes == [])
        ob = Observation(json.dumps(dict((obs_1, dat3, loc3, prop2, res_(6)))))
        majType_avec_option(ob, maj_index)
        self.assertTrue(ob.score == 225 and ob.complet and ob.setResult.axes == [10, 2])
        #envoi_mongo(ob)
        #ob.option[&#34;json_res_index&#34;] = True
        #print(ob.json(), &#39;\n&#39;)</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObservation.test_obs_options"><code class="name flex">
<span>def <span class="ident">test_obs_options</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_obs_options(self):
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(9)))))
    option_simple(ob1)
    ob1.option[&#34;json_res_index&#34;] = True
    self.assertEqual(json.loads(ob1.json())[ES.res_valName[0]][0], [val_(9)[0], ES.nullInd])
    ob1.option[&#34;json_ESobs_class&#34;] = True
    self.assertTrue(ES.dat_classES in json.loads(ob1.json()))
    self.assertTrue(ES.res_classES in json.loads(ob1.json()))
    self.assertTrue(ES.loc_classES in json.loads(ob1.json()))
    self.assertTrue(ES.prp_classES in json.loads(ob1.json()))
    ob1.option[&#34;json_elt_type&#34;] = True
    self.assertTrue(ES.type + ES.dat_classES in json.loads(ob1.json())[ES.dat_classES])
    self.assertTrue(ES.type + ES.res_classES in json.loads(ob1.json())[ES.res_classES])
    self.assertTrue(ES.type + ES.loc_classES in json.loads(ob1.json())[ES.loc_classES])
    self.assertTrue(ES.type + ES.prp_classES in json.loads(ob1.json())[ES.prp_classES])
    ob1.option[&#34;json_obs_val&#34;] = False
    self.assertTrue(ES.dat_classES in json.loads(&#39;{&#39; + ob1.json() + &#39;}&#39;))
    ob1.option[&#34;json_obs_val&#34;] = True
    ob1.option[&#34;json_obs_attrib&#34;] = True
    self.assertTrue(ES.obs_attributes in json.loads(ob1.json()))
    ob1.option[&#34;json_info_type&#34;] = True
    ob1.option[&#34;json_info_nval&#34;] = True
    ob1.option[&#34;json_info_autre&#34;] = True
    ob1.option[&#34;json_info_box&#34;] = True
    ob2 = Observation(ob1.json())
    self.assertTrue(ES.type in json.loads(ob2.json()))</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObservation.test_obs_polygon"><code class="name flex">
<span>def <span class="ident">test_obs_polygon</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_obs_polygon(self):
    ob = Observation(json.dumps(dict((obs_1, dat3, dpt2, prop2, res_(6)))))
    ob.option[&#34;json_loc_point&#34;] = False
    self.assertEqual(json.dumps(ob.__geo_interface__), 
                     json.dumps({&#34;type&#34;: &#34;MultiPolygon&#34;, &#34;coordinates&#34;: dpt2[1]}))</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObservation.test_obs_simple"><code class="name flex">
<span>def <span class="ident">test_obs_simple</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_obs_simple(self):
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3))))
    option_simple(ob1)
    self.assertEqual(dict((obs_1, truc_mach, dat3sn)),    json.loads(ob1.json()))
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, loc3))))
    option_simple(ob1)
    self.assertEqual(dict((obs_1, truc_mach, loc3sn)),    json.loads(ob1.json()))
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, prop2))))
    option_simple(ob1)
    ob1.option[&#34;json_prp_type&#34;] = False
    self.assertEqual(dict((obs_1, truc_mach, prop2)),    json.loads(ob1.json()))
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, res_(9)))))
    option_simple(ob1)
    self.assertEqual(dict((obs_1, truc_mach, res_(9))),    json.loads(ob1.json()))
    ob1 = Observation(json.dumps(dict((obs_1, truc_mach, dat3, loc3, prop2, res_(9)))))
    option_simple(ob1)
    self.assertEqual(dict((obs_1, truc_mach, dat3sn, loc3sn, prop2, res_(9))),json.loads(ob1.json()))</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObservation.test_obs_sort"><code class="name flex">
<span>def <span class="ident">test_obs_sort</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_obs_sort(self):
    ob = Observation(dict((obs_1, dat3, dpt3, prop2, res_(6))), &#39;px&#39;)
    test = ob.iloc(1,1,0)
    ob.sort(cross = False)
    self.assertEqual(ob.iloc(2,1,1), test)
    ob.sort()
    self.assertEqual(ob.iloc(2,2,1), test)
    ob.sort(cross = False, order = [1,0,2])
    self.assertEqual(ob.iloc(2,1,1), test)
    ob.sort(order = [1,0,2])
    self.assertEqual(ob.iloc(1,1,1), test)</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObservation.test_obs_vList"><code class="name flex">
<span>def <span class="ident">test_obs_vList</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_obs_vList(self):
    ob1 = Observation(dict((obs_1, truc_mach, dat3, loc3)))
    self.assertEqual(ob1.setDatation.vListName[0], &#39;date1&#39;)
    self.assertEqual(ob1.setDatation.vListName[1], &#39;dat1&#39;)
    self.assertEqual(ob1.setLocation.vListPoint, [paris, lyon, marseille])
    self.assertEqual(ob1.setDatation.vListInstant, [t1, t2, t3])
    ob1 = Observation(dict((obs_1, truc_mach, dat3, dpt2)))
    self.assertEqual(ob1.setLocation.vListPoint[0], pol1centre)</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObservation.test_sensor"><code class="name flex">
<span>def <span class="ident">test_sensor</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_sensor(self):
    obs = Observation()
    nprop1 = obs.addValue(PropertyValue(prop_pm25))
    for i in range(6): # simule une boucle de mesure
        nres = obs.addValueSensor(ResultValue(45+i), 
                            DatationValue(datetime(2021, 6, 4+i, 12, 5).isoformat()),
                            LocationValue([14+i, 40]),
                            nprop1)
    obs.majType()
    obs.option[&#34;json_ESobs_class&#34;] = True
    obs.option[&#34;json_elt_type&#34;] = True
    self.assertEqual(json.loads(obs.json())[ES.information][&#34;typeobs&#34;], ES.obsCat[122])</code></pre>
</details>
</dd>
<dt id="ES.EStestunitaire.TestObservation.test_xarray"><code class="name flex">
<span>def <span class="ident">test_xarray</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_xarray(self):
    ob = Observation(dict((obs_1, dat3, loc3, prop2, res_(6))), &#39;xp&#39;)
    self.assertTrue(ob.to_xarray()[2,1].item() == ResultValue(2))
    ob = Observation(dict((obs_1, dat3, loc3, prop1, res_(3))), &#39;xp&#39;)
    self.assertTrue(ob.to_xarray()[1].item() == ResultValue(2))
    ob = Observation(dict((obs_1, dat3, loc3, prop3, res_(3))), &#39;dlp&#39;)
    self.assertTrue(ob.to_xarray()[1].item() == ResultValue(2))
    ob = Observation(dict((obs_1, dat3, loc3, prop2, res_(18))), &#39;dlp&#39;)
    self.assertTrue(ob.to_xarray()[2,1,0].item() == ResultValue(9))
    ob = Observation(dict((obs_1, dat3, loc2, prop1, res_(6))), &#39;dlp&#39;)
    self.assertTrue(ob.to_xarray()[2,0].item() == ResultValue(2))</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="ES" href="index.html">ES</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="ES.EStestunitaire.envoi_mongo" href="#ES.EStestunitaire.envoi_mongo">envoi_mongo</a></code></li>
<li><code><a title="ES.EStestunitaire.majType_avec_option" href="#ES.EStestunitaire.majType_avec_option">majType_avec_option</a></code></li>
<li><code><a title="ES.EStestunitaire.option_simple" href="#ES.EStestunitaire.option_simple">option_simple</a></code></li>
<li><code><a title="ES.EStestunitaire.res_" href="#ES.EStestunitaire.res_">res_</a></code></li>
<li><code><a title="ES.EStestunitaire.val_" href="#ES.EStestunitaire.val_">val_</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="ES.EStestunitaire.TestBytes" href="#ES.EStestunitaire.TestBytes">TestBytes</a></code></h4>
<ul class="">
<li><code><a title="ES.EStestunitaire.TestBytes.test_datation_bytes" href="#ES.EStestunitaire.TestBytes.test_datation_bytes">test_datation_bytes</a></code></li>
<li><code><a title="ES.EStestunitaire.TestBytes.test_location_bytes" href="#ES.EStestunitaire.TestBytes.test_location_bytes">test_location_bytes</a></code></li>
<li><code><a title="ES.EStestunitaire.TestBytes.test_observation_bytes" href="#ES.EStestunitaire.TestBytes.test_observation_bytes">test_observation_bytes</a></code></li>
<li><code><a title="ES.EStestunitaire.TestBytes.test_property_bytes" href="#ES.EStestunitaire.TestBytes.test_property_bytes">test_property_bytes</a></code></li>
<li><code><a title="ES.EStestunitaire.TestBytes.test_result_bytes" href="#ES.EStestunitaire.TestBytes.test_result_bytes">test_result_bytes</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ES.EStestunitaire.TestObsUnitaire" href="#ES.EStestunitaire.TestObsUnitaire">TestObsUnitaire</a></code></h4>
<ul class="">
<li><code><a title="ES.EStestunitaire.TestObsUnitaire.opt" href="#ES.EStestunitaire.TestObsUnitaire.opt">opt</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObsUnitaire.test_DatationValue" href="#ES.EStestunitaire.TestObsUnitaire.test_DatationValue">test_DatationValue</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObsUnitaire.test_ESElement" href="#ES.EStestunitaire.TestObsUnitaire.test_ESElement">test_ESElement</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObsUnitaire.test_ESObs" href="#ES.EStestunitaire.TestObsUnitaire.test_ESObs">test_ESObs</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObsUnitaire.test_ESSet" href="#ES.EStestunitaire.TestObsUnitaire.test_ESSet">test_ESSet</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObsUnitaire.test_ResultValue" href="#ES.EStestunitaire.TestObsUnitaire.test_ResultValue">test_ResultValue</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObsUnitaire.test_locationValue" href="#ES.EStestunitaire.TestObsUnitaire.test_locationValue">test_locationValue</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObsUnitaire.test_majValue_majName" href="#ES.EStestunitaire.TestObsUnitaire.test_majValue_majName">test_majValue_majName</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObsUnitaire.test_nameValue" href="#ES.EStestunitaire.TestObsUnitaire.test_nameValue">test_nameValue</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObsUnitaire.test_propertyValue" href="#ES.EStestunitaire.TestObsUnitaire.test_propertyValue">test_propertyValue</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ES.EStestunitaire.TestObservation" href="#ES.EStestunitaire.TestObservation">TestObservation</a></code></h4>
<ul class="">
<li><code><a title="ES.EStestunitaire.TestObservation.test_exports" href="#ES.EStestunitaire.TestObservation.test_exports">test_exports</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObservation.test_geo_interface" href="#ES.EStestunitaire.TestObservation.test_geo_interface">test_geo_interface</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObservation.test_obs_add" href="#ES.EStestunitaire.TestObservation.test_obs_add">test_obs_add</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObservation.test_obs_att" href="#ES.EStestunitaire.TestObservation.test_obs_att">test_obs_att</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObservation.test_obs_creation" href="#ES.EStestunitaire.TestObservation.test_obs_creation">test_obs_creation</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObservation.test_obs_dim" href="#ES.EStestunitaire.TestObservation.test_obs_dim">test_obs_dim</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObservation.test_obs_extend" href="#ES.EStestunitaire.TestObservation.test_obs_extend">test_obs_extend</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObservation.test_obs_majIndex_iloc" href="#ES.EStestunitaire.TestObservation.test_obs_majIndex_iloc">test_obs_majIndex_iloc</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObservation.test_obs_majListName_majListValue" href="#ES.EStestunitaire.TestObservation.test_obs_majListName_majListValue">test_obs_majListName_majListValue</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObservation.test_obs_maj_type" href="#ES.EStestunitaire.TestObservation.test_obs_maj_type">test_obs_maj_type</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObservation.test_obs_options" href="#ES.EStestunitaire.TestObservation.test_obs_options">test_obs_options</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObservation.test_obs_polygon" href="#ES.EStestunitaire.TestObservation.test_obs_polygon">test_obs_polygon</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObservation.test_obs_simple" href="#ES.EStestunitaire.TestObservation.test_obs_simple">test_obs_simple</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObservation.test_obs_sort" href="#ES.EStestunitaire.TestObservation.test_obs_sort">test_obs_sort</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObservation.test_obs_vList" href="#ES.EStestunitaire.TestObservation.test_obs_vList">test_obs_vList</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObservation.test_sensor" href="#ES.EStestunitaire.TestObservation.test_sensor">test_sensor</a></code></li>
<li><code><a title="ES.EStestunitaire.TestObservation.test_xarray" href="#ES.EStestunitaire.TestObservation.test_xarray">test_xarray</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.8.1</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>